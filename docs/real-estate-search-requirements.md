# 不動産取引価格検索機能 要件定義書

## 概要
国土交通省の不動産情報ライブラリAPIを利用して、指定した地域の不動産取引価格情報を検索・表示する機能

## ユーザーシナリオ

### 検索フロー
1. **都道府県を選択**（例：埼玉県）
2. **市区町村を選択**（例：大宮区）
3. **地区名を入力**（例：北袋町）
4. **種類を選択**
   - 01: 宅地（土地）
   - 02: 宅地（土地と建物）
   - 07: 中古マンション等
5. **取引時期を選択**（例：2024年第1四半期〜第4四半期）
6. **検索実行**

### 検索結果表示
```
検索結果一覧
埼玉県 大宮区 北袋町の土地取引件数 36 件

検索条件：埼玉県 大宮区 北袋町 / 宅地（土地及び土地と建物） / 2024年第1四半期 から 2024年第4四半期 まで
```

## データ構造

### 入力パラメータ
```python
{
    "prefecture": "埼玉県",          # 都道府県
    "city": "大宮区",               # 市区町村
    "district": "北袋町",           # 地区名
    "type": ["01", "02"],          # 取引種類（複数選択可）
    "from_year": 2024,             # 開始年
    "from_quarter": 1,             # 開始四半期
    "to_year": 2024,               # 終了年
    "to_quarter": 4                # 終了四半期
}
```

### 出力データ
```python
{
    "total_count": 36,             # 総件数
    "search_count": 6,             # 検索結果件数
    "search_conditions": {
        "location": "埼玉県 大宮区 北袋町",
        "types": ["宅地（土地）", "宅地（土地と建物）"],
        "period": "2024年第1四半期 から 2024年第4四半期"
    },
    "results": [
        {
            "no": 1,
            "type": "宅地(土地と建物)",
            "price_type": "成約価格情報",
            "location": "さいたま市大宮区 北袋町",
            "region": "",
            "station": "さいたま新都心",
            "station_distance": "20分",
            "price": 31000000,              # 取引総額（円）
            "price_formatted": "3,100万円",
            "land_area": 100,               # 土地面積（㎡）
            "building_area": 130,           # 延床面積（㎡）
            "build_year": "1999年",
            "structure": "",                # 構造
            "road_width": 4.0,              # 前面道路幅員（m）
            "road_type": "公道",            # 道路種類
            "road_direction": "北",         # 道路方位
            "city_planning": "１中住専",     # 都市計画
            "coverage_ratio": 60,           # 建蔽率（%）
            "floor_area_ratio": 160,        # 容積率（%）
            "trade_period": "2024年第3四半期",
            "unit_price": 310000,           # ㎡単価（円）
            "unit_price_formatted": "31万円",
            "tsubo_price": 1023000,         # 坪単価（円）
            "tsubo_price_formatted": "102.3万円"
        }
    ]
}
```

## API仕様

### 必要なAPIエンドポイント
1. **都道府県リスト取得** - `/api/prefectures`
2. **市区町村リスト取得** - `/api/cities/{prefecture_code}`
3. **不動産取引価格検索** - `/api/real-estate/search`

### 実装上の注意点
1. **APIキー管理** - 環境変数で管理
2. **データ変換** - 都道府県名→コード変換が必要
3. **期間指定** - 複数四半期の場合は複数回APIコール
4. **ページング** - 大量データ対応
5. **エラーハンドリング** - API制限、データなしケース

## UI要件

### 検索フォーム
- 都道府県：プルダウン選択
- 市区町村：プルダウン選択（都道府県選択後に動的更新）
- 地区名：テキスト入力
- 種類：チェックボックス（複数選択可）
- 期間：年・四半期のプルダウン選択

### 結果表示
- 検索条件サマリー
- 件数表示
- テーブル形式での一覧表示
- ソート機能（価格、面積、築年など）
- ページネーション

## 技術仕様

### バックエンド
- FastAPI
- 不動産情報ライブラリAPI連携
- キャッシュ機能（Redis推奨）

### フロントエンド
- HTML/CSS/JavaScript
- 動的フォーム更新
- レスポンシブデザイン

## 拡張機能（将来）
1. **地図表示** - 物件位置をマップ上に表示
2. **統計分析** - 平均価格、価格推移グラフ
3. **CSV出力** - 検索結果のダウンロード
4. **詳細フィルター** - 築年数、駅距離など
5. **お気に入り保存** - ユーザー登録機能と連携

---

**作成日**: 2024-06-19