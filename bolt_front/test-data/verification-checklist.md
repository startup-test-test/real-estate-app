# 🔍 リファクタリング検証チェックリスト

## 📋 必須検証項目（各ステップ共通）

### ✅ ビルド・コンパイル確認
- [ ] `npm run build` が成功する
- [ ] TypeScriptコンパイルエラーがない
- [ ] ESLint警告・エラーがない
- [ ] 開発サーバーが正常起動する（`npm run dev`）

### ✅ 基本機能確認
- [ ] シミュレーターページにアクセスできる
- [ ] サンプル物件選択が動作する
- [ ] フォーム入力が正常に動作する
- [ ] シミュレーション実行ボタンが押せる
- [ ] シミュレーション結果が表示される

### ✅ UI/UX確認  
- [ ] レイアウトが元と同じ
- [ ] スタイリング（色・フォント・間隔）が保持されている
- [ ] レスポンシブ対応が維持されている
- [ ] ツールチップ表示が正常動作
- [ ] ローディング状態が適切に表示される

### ✅ 機能詳細確認
- [ ] メトリクスカードが正しく表示される
- [ ] キャッシュフローチャートが表示される
- [ ] キャッシュフローテーブルが表示される
- [ ] PDF出力機能が動作する
- [ ] 共有機能が動作する（該当する場合）

### ✅ エラーハンドリング確認
- [ ] ブラウザコンソールにエラーが出ない
- [ ] ネットワークエラー時の適切な表示
- [ ] バリデーションエラーの適切な表示
- [ ] 不正な入力値での適切な処理

## 🧪 テストケース別確認

### テストケース1: 基本テストケース
- [ ] 渋谷区ワンルームのデータで正常実行
- [ ] ROIが期待範囲（10-20%）に入る
- [ ] 全メトリクスが表示される
- [ ] チャートが正常表示される

### テストケース2: 最小値テストケース  
- [ ] 最小限データで正常実行
- [ ] エラーが発生しない
- [ ] 計算結果が妥当

### テストケース3: 大規模物件テストケース
- [ ] 大規模データで正常実行
- [ ] 法人税率の計算が正しい
- [ ] 高額物件での表示が適切

## ⚠️ 自動ロールバック判定項目

以下のいずれかが発生した場合は**即座にロールバック**:

### 🚨 Critical Issues
- [ ] ビルドエラーが5分以上解決しない
- [ ] シミュレーション実行が失敗する
- [ ] 白画面・クラッシュが発生する
- [ ] TypeScriptエラーが解決できない

### ⚠️ Major Issues  
- [ ] UI表示が大きく変わる
- [ ] 主要機能が動作しない
- [ ] 計算結果が明らかに間違っている
- [ ] パフォーマンスが著しく悪化する

### 🔍 Minor Issues（要注意、対応可能なら継続）
- [ ] 軽微なスタイル変更
- [ ] 一部のツールチップ動作
- [ ] 軽微な警告メッセージ

## 📊 各ステップ専用チェック項目

### Step 1-1: ユーティリティ関数抽出
- [ ] validateUrl 関数が正常動作
- [ ] PDF生成機能が正常動作
- [ ] データ変換が正常動作
- [ ] 既存の機能が全て同じように動作

### Step 1-2: 定数・設定データ抽出
- [ ] サンプル物件データが正常読み込み
- [ ] ツールチップテキストが正常表示
- [ ] メトリクスしきい値が正常動作
- [ ] 初期値設定が正常動作

### Step 1-3: 型定義の分離
- [ ] 型チェックが正常動作
- [ ] インポート文が全て解決
- [ ] IDE補完が正常動作
- [ ] 型安全性が維持されている

### Step 1-4: カスタムフック抽出
- [ ] 状態管理が正常動作
- [ ] APIコールが正常動作
- [ ] フォーム状態が正常動作
- [ ] リアクティブ更新が正常動作

### Step 1-5: 最小コンポーネント抽出
- [ ] 分離したコンポーネントが正常表示
- [ ] 親コンポーネントとの連携が正常
- [ ] プロパティ受け渡しが正常
- [ ] イベント処理が正常動作

## 🎯 品質ゲート（次のステップに進む条件）

### ✅ 必須条件（ALL クリア必要）
- [ ] 必須検証項目が全てクリア
- [ ] 自動ロールバック判定項目でCritical/Major Issuesが0件
- [ ] ユーザーによる動作確認完了
- [ ] 変更内容のドキュメント化完了

### 🔍 推奨条件（可能な限り）
- [ ] コードレビュー完了
- [ ] ログメッセージの確認
- [ ] パフォーマンス測定
- [ ] アクセシビリティチェック

## 📝 検証記録テンプレート

```
## 検証実施日: YYYY/MM/DD
## ステップ: [Phase-0 / Step-1-1 / etc.]
## 実施者: [名前]

### 必須検証結果
- ビルド・コンパイル: [ OK / NG ]
- 基本機能: [ OK / NG ]  
- UI/UX: [ OK / NG ]
- 機能詳細: [ OK / NG ]
- エラーハンドリング: [ OK / NG ]

### テストケース結果
- テストケース1: [ OK / NG ]
- テストケース2: [ OK / NG ]
- テストケース3: [ OK / NG ]

### 問題・改善点
- [問題があれば記載]

### 次のステップへの判定
- [ ] 進む（全項目クリア）
- [ ] ロールバック（理由: ）
```