"""
GPT-4o-mini を使用した不動産市場分析サンプル
実際のデータ例と期待される出力結果を示します
"""

# ============================================
# 1. 入力データ例（フロントエンドから送信される実際のデータ）
# ============================================

sample_input_data = {
    "market_data": {
        "prefecture": "東京都",
        "city": "世田谷区",
        "district": "三軒茶屋",
        "averagePrice": 5800,  # 万円
        "totalTransactions": 45,
        "q25": 4200,  # 第1四分位
        "q50": 5500,  # 中央値
        "q75": 7200,  # 第3四分位
        "priceChange": 5.2  # 前年比%
    },

    "similar_properties": [
        {
            "取引価格（万円）": 5200,
            "延べ床面積（㎡）": 95,
            "建築年": 2018,
            "取引時期": "2024年第1四半期",
            "最寄駅": "三軒茶屋",
            "駅からの距離": "徒歩5分"
        },
        {
            "取引価格（万円）": 6300,
            "延べ床面積（㎡）": 110,
            "建築年": 2020,
            "取引時期": "2024年第1四半期",
            "最寄駅": "池尻大橋",
            "駅からの距離": "徒歩8分"
        },
        {
            "取引価格（万円）": 4800,
            "延べ床面積（㎡）": 85,
            "建築年": 2015,
            "取引時期": "2024年第2四半期",
            "最寄駅": "三軒茶屋",
            "駅からの距離": "徒歩10分"
        }
    ],

    "land_price_data": [
        {
            "address": "世田谷区太子堂2-16-7",
            "price_per_sqm": 1250000,  # 円/㎡
            "year": 2024,
            "change_rate": 3.5  # 前年比%
        },
        {
            "address": "世田谷区三軒茶屋1-35-1",
            "price_per_sqm": 1450000,
            "year": 2024,
            "change_rate": 4.2
        }
    ],

    "target_area": 100,  # 希望延床面積（㎡）
    "target_year": 2018  # 希望建築年
}

# ============================================
# 2. GPT-4o-miniに送るプロンプト（実際の処理内容）
# ============================================

prompt_to_gpt = """
【対象地域】東京都 世田谷区 三軒茶屋
【平均価格】5,800万円
【取引件数】45件
【価格分布】
- 第1四分位: 4,200万円
- 中央値: 5,500万円
- 第3四分位: 7,200万円
【前年比】+5.2%

【検索条件】希望延床面積: 100㎡, 希望建築年: 2018年

【類似物件データ】3件
1. 価格: 5,200万円, 面積: 95㎡, ㎡単価: 55万円, 建築年: 2018, 取引時期: 2024年1〜3月
2. 価格: 6,300万円, 面積: 110㎡, ㎡単価: 57万円, 建築年: 2020, 取引時期: 2024年1〜3月
3. 価格: 4,800万円, 面積: 85㎡, ㎡単価: 56万円, 建築年: 2015, 取引時期: 2024年4〜6月

【公示地価データ】2地点
平均公示地価: 1,350,000円/㎡
前年比変動率: +3.85%

上記のデータに基づいて、以下の観点から市場分析サマリーを作成してください：
1. 現在の市場動向と価格帯の特徴
2. 類似物件との比較分析
3. 投資または購入の観点からの評価
4. 今後の見通しと推奨事項

簡潔で実用的な分析を400字程度でまとめてください。
"""

# ============================================
# 3. GPT-4o-miniからの実際の応答例
# ============================================

gpt_response_example = {
    "summary": """
世田谷区三軒茶屋エリアの不動産市場は堅調な成長を示しています。平均価格5,800万円、中央値5,500万円と安定した価格帯を形成し、前年比+5.2%の上昇は都心アクセスの良さと住環境の質が評価されている証拠です。

ご希望条件（100㎡、2018年築）に近い物件の㎡単価は55-57万円で推移しており、市場相場として妥当な水準です。特に築5年以内の物件は高い需要があり、価格も安定しています。

公示地価が年3.85%上昇している点も注目すべきで、エリア全体の資産価値向上が期待できます。価格分布を見ると、4,200万円から7,200万円と幅広く、予算に応じた選択肢が豊富です。

投資観点では、賃貸需要も高く、利回り3-4%が見込めるエリアです。購入を検討される場合は、駅徒歩10分以内の物件を優先し、築10年以内を目安にすることで、将来的な売却時も有利になるでしょう。現在の市場環境は購入に適したタイミングと言えます。
    """,

    "key_insights": [
        "市場価格は前年比+5.2%上昇、エリア人気が継続",
        "㎡単価55-57万円が相場、築浅物件は特に安定",
        "公示地価も年3.85%上昇、資産価値向上が期待",
        "価格帯4,200-7,200万円と選択肢が豊富",
        "駅近・築浅物件の需要が特に高い"
    ],

    "recommendations": [
        "駅徒歩10分以内の物件を優先的に検討",
        "築10年以内を目安に物件選定することを推奨",
        "現在の市場環境は購入に適したタイミング"
    ]
}

# ============================================
# 4. フロントエンドでの表示例
# ============================================

frontend_display = """
📊 AI市場分析レポート
━━━━━━━━━━━━━━━━━━━━━━━━

【エリア概況】
世田谷区三軒茶屋エリアの不動産市場は堅調な成長を示しています。
平均価格5,800万円、中央値5,500万円と安定した価格帯を形成...

【主要な洞察】
✓ 市場価格は前年比+5.2%上昇、エリア人気が継続
✓ ㎡単価55-57万円が相場、築浅物件は特に安定
✓ 公示地価も年3.85%上昇、資産価値向上が期待

【投資アドバイス】
• 駅徒歩10分以内の物件を優先的に検討
• 築10年以内を目安に物件選定することを推奨
• 現在の市場環境は購入に適したタイミング

【データ基準日】2024年第2四半期
"""

# ============================================
# 5. 実装のメリット
# ============================================

benefits = """
✅ 自分でロジックを作る必要なし
   - GPTが自動で市場トレンド分析
   - 複雑な統計計算も不要
   - 自然な日本語で説明生成

✅ 柔軟な分析が可能
   - データが少なくても意味のある分析
   - 地域特性を考慮した分析
   - 季節要因や経済状況も加味

✅ ユーザーフレンドリー
   - 専門用語を適切に解説
   - 実用的なアドバイス提供
   - 読みやすい要約形式

✅ コスト効率
   - 1リクエスト約1円以下
   - 開発工数大幅削減
   - メンテナンス不要
"""

print("=" * 60)
print("GPT-4o-miniを使った不動産市場分析の実装例")
print("=" * 60)
print("\n入力データ項目:", list(sample_input_data.keys()))
print("\n出力結果:", list(gpt_response_example.keys()))
print("\n" + benefits)