# 開発環境起動手順

## 概要
不動産アプリケーションの開発環境を起動する手順を説明します。

## API情報
- **本番API URL**: https://property-develop.onrender.com
- **APIドキュメント**: https://property-develop.onrender.com/docs

## 起動手順

### 1. フロントエンドの起動

```bash
# bolt_frontディレクトリに移動
cd /workspaces/real-estate-app/bolt_front

# 開発サーバーを起動
npm run dev
```

起動後、以下のメッセージが表示されます：
```
VITE v5.4.19  ready in xxxx ms

➜  Local:   http://localhost:5173/
➜  Network: http://10.0.1.xxx:5173/
```

### 2. GitHub Codespaces でのアクセス

GitHub Codespacesで開発している場合、自動的にポートフォワーディングされます。

**アクセスURL形式**:
```
https://{CODESPACE_NAME}-5173.app.github.dev
```

例：
```
https://fluffy-space-waddle-g4rjjrr94459h9q69-5173.app.github.dev
```

### 3. API接続設定

フロントエンドはvite.config.tsで設定されたプロキシを通じてAPIに接続します。

**vite.config.ts の設定**:
```typescript
server: {
  host: true,
  port: 5173,
  proxy: {
    '/api': {
      target: 'https://property-develop.onrender.com',
      changeOrigin: true,
      secure: true
    }
  }
}
```

この設定により、フロントエンドの`/api/*`へのリクエストは自動的に本番APIサーバーにプロキシされます。

## API エンドポイント一覧

### 基本エンドポイント
- `GET /api/prefectures` - 都道府県一覧取得
- `GET /api/municipalities/{prefecture_code}` - 市区町村一覧取得
- `GET /api/districts/{city_code}` - 地区一覧取得

### 不動産取引データ
- `GET /api/properties` - 物件取引データ取得
  - パラメータ:
    - `prefecture_code`: 都道府県コード
    - `city_code`: 市区町村コード
    - `district_name`: 地区名
    - `from_year`: 開始年
    - `from_quarter`: 開始四半期
    - `to_year`: 終了年
    - `to_quarter`: 終了四半期
    - `property_type`: 物件種別（マンション/戸建/土地）

### 公示地価データ
- `GET /api/land-prices` - 公示地価データ取得
  - パラメータ:
    - `prefecture_name`: 都道府県名
    - `city_name`: 市区町村名
    - `district_name`: 地区名
    - `year`: 年度

## トラブルシューティング

### API接続エラーが発生する場合

1. **ブラウザのコンソールを確認**
   - Network タブでAPIリクエストのステータスを確認
   - 404エラー: エンドポイントのパスを確認
   - 500エラー: APIサーバー側のエラー

2. **プロキシ設定の確認**
   ```bash
   # vite.config.tsの設定を確認
   cat bolt_front/vite.config.ts | grep -A 5 proxy
   ```

3. **APIサーバーの稼働状況確認**
   ```bash
   # APIヘルスチェック
   curl https://property-develop.onrender.com/health
   ```

### ポートフォワーディングが機能しない場合

1. **Codespace環境変数の確認**
   ```bash
   echo $CODESPACE_NAME
   echo $GITHUB_CODESPACES_PORT_FORWARDING_DOMAIN
   ```

2. **ポート5173が使用されているか確認**
   ```bash
   lsof -i :5173
   ```

## ローカルAPIサーバーの起動（オプション）

ローカルでAPIサーバーを起動する場合：

```bash
# backendディレクトリに移動
cd /workspaces/real-estate-app/backend/property-api

# 必要な環境変数を設定
export SUPABASE_URL=your_supabase_url
export SUPABASE_KEY=your_supabase_key

# APIサーバーを起動
python main.py
```

ローカルAPIを使用する場合は、vite.config.tsのプロキシ設定を変更：
```typescript
proxy: {
  '/api': {
    target: 'http://127.0.0.1:8000',
    changeOrigin: true,
    secure: false
  }
}
```

## 注意事項

- 本番APIサーバー（Render）は初回アクセス時に起動に時間がかかる場合があります（コールドスタート）
- 開発中はブラウザの開発者ツールを開いてネットワークタブでAPI通信を確認することを推奨
- APIレート制限に注意してください

## 関連ドキュメント

- [AI市場分析の計算ロジック](./AI市場分析の計算ロジック.md)
- [APIエンドポイント詳細仕様](./index.html)
- [環境変数管理ガイド](../../../環境変数管理ガイド.md)