# 実装優先順位ロードマップ

## 🎯 Phase 1: 必須機能の実装（1-2日）

### 目標
フロントエンドで0表示されている値をすべて解消する

### タスク
1. **元金返済額の計算実装**（2時間）
   - 月次の利息計算
   - 元金部分の算出
   - キャッシュフロー表への反映

2. **借入残高の計算実装**（2時間）
   - 既存関数の活用
   - 各年の残高計算
   - 売却分析への連携

3. **自己資金回収率の実装**（1時間）
   - 累計CFベースの計算
   - パーセンテージ表示

4. **売却時手取りの実装**（3時間）
   - 譲渡所得税の簡易計算
   - 売却コストの反映
   - 各年での想定計算

### 成果物
- すべての0表示が解消されたAPI
- 完全なキャッシュフロー表

## 🔄 Phase 2: 計算精度の向上（3-5日）

### 目標
より正確で実用的な計算ロジックの実装

### タスク
1. **税金計算の詳細化**
   - 所得税率のテーブル化
   - 住民税の考慮
   - 事業税の追加

2. **減価償却の詳細計算**
   - 建物構造別の償却率
   - 設備部分の分離
   - 定率法オプション

3. **売却時の詳細計算**
   - 長期/短期譲渡の判定
   - 特別控除の考慮
   - 仲介手数料の詳細計算

## 🚀 Phase 3: 新機能の追加（1週間）

### 目標
競合サービスとの差別化機能

### タスク
1. **シナリオ分析機能**
   - 金利変動シミュレーション
   - 賃料下落シナリオ
   - 最悪ケース分析

2. **融資条件の最適化**
   - 複数の融資パターン比較
   - 最適な自己資金比率の提案

3. **投資判断サポート**
   - 投資判断の自動評価
   - リスクスコアの算出
   - 改善提案の生成

## 📊 実装状況ダッシュボード

```
Phase 1: [====------] 40% 完了
Phase 2: [----------] 0% 未着手
Phase 3: [----------] 0% 未着手

全体進捗: [==--------] 13% 完了
```

## ✅ 完了基準

### Phase 1完了の条件
- [ ] API検証で0表示がない
- [ ] フロントエンドで正しく表示
- [ ] 基本的な計算の妥当性確認

### Phase 2完了の条件
- [ ] 税理士レビューでの承認
- [ ] 実際の確定申告書との照合
- [ ] エッジケースでの動作確認

### Phase 3完了の条件
- [ ] ユーザビリティテスト実施
- [ ] パフォーマンステスト合格
- [ ] セキュリティ監査通過

## 🛠️ 技術的な実装指針

### コーディング規約
1. **関数の単一責任**
   - 1関数1機能の原則
   - 30行以内を目安

2. **テスタビリティ**
   - 純粋関数として実装
   - 副作用の最小化

3. **ドキュメント**
   - 各関数にdocstring
   - 複雑な計算にはコメント

### テスト方針
1. **単体テスト**
   - 各計算関数のテスト
   - エッジケースの網羅

2. **統合テスト**
   - API全体のテスト
   - 実際のユースケース

3. **回帰テスト**
   - 修正による影響確認
   - ゴールデンテストの活用

---
作成日: 2025年7月28日
次回レビュー予定: 2025年8月4日