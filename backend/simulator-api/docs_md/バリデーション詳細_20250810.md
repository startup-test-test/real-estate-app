# バリデーション詳細仕様書（2025年8月10日更新）

## 実装済みバリデーション一覧

### 1. 必須項目チェック（BUG_010）
**実装場所**: `bolt_front/src/pages/Simulator.tsx` L472-496

#### 必須項目
- 物件名（propertyName）
- 所在地（location）
- 建築年（yearBuilt）
- 建物構造（propertyType）
- 物件価格（purchasePrice）
- 月額賃料（monthlyRent）

#### 動作
- 未入力時にエラーメッセージ表示
- 最初のエラーフィールドに自動スクロール
- フィールドごとのエラー表示

---

### 2. ゼロ値バリデーション（BUG_008）
**実装場所**: `bolt_front/src/pages/Simulator.tsx` L498-529

#### チェック対象
- 物件価格: 0より大きい値必須
- 月額賃料: 0より大きい値必須

#### 動作
- NaN/Infinityエラーを防止
- 「0より大きい値を入力してください」のエラー表示

---

### 3. 上限値チェック（BUG_009）
**実装場所**: `bolt_front/src/pages/Simulator.tsx` L531-581

#### 各フィールドの上限値
| フィールド | 上限値 | エラーメッセージ |
|-----------|--------|-----------------|
| 物件価格 | 100億円（1,000,000万円） | 物件価格は100億円以下で入力してください |
| 月額賃料 | 1,000万円 | 月額賃料は1000万円以下で入力してください |
| 借入期間 | 50年 | 借入期間は50年以下で入力してください |
| 金利 | 20% | 金利は20%以下で入力してください |
| 保有期間 | 50年 | 保有期間は50年以下で入力してください |
| 管理手数料 | 月額賃料の50% | 管理手数料は月額賃料の50%以下で入力してください |

---

### 4. 建築年の範囲チェック（BUG_012）
**実装場所**: `bolt_front/src/pages/Simulator.tsx` L559-565

#### 許可範囲
- 最小値: 1900年
- 最大値: 現在年 + 5年（建設予定物件対応）

#### 特別な表示
- 未来の年の場合: 「建設予定（YYYY年完成予定）」と表示
- 過去の年の場合: 「築XX年（YYYY年現在）」と表示

---

### 5. 表面利回り制限（BUG_013）
**実装場所**: `bolt_front/src/pages/Simulator.tsx` L531-542

#### 制限値
- 最大表面利回り: 99%
- 計算式: (月額賃料 × 12) / 物件価格 × 100

---

### 6. 全角数字変換（BUG_011）
**実装場所**: `bolt_front/src/pages/Simulator.tsx` L282-299

#### 変換対象
- 全角数字（０-９）→ 半角数字（0-9）
- 全角ピリオド（．）→ 半角ピリオド（.）
- 全角カンマ（，）→ 半角カンマ（,）→ 削除

#### 注意事項
- type="number"のHTML制限により、実際の全角入力は制限される場合あり

---

## 今後の実装予定

### 中優先度
- BUG_005: 管理手数料％入力パーサー（「5%」と入力して自動計算）
- BUG_015: 自動計算タイミング（手動変更の保持）
- BUG_016: カンマ付き数値処理（「1,234,567」のコピペ対応）
- BUG_020: 文字数上限（物件名200文字制限）

### 低優先度
- BUG_006: 最小値での利回り計算
- BUG_007: 大数値の表示形式（カンマ区切り）
- BUG_017: 浮動小数点精度
- BUG_018: エラー復帰処理

---

## バックエンド対応状況

現在、バックエンドではバリデーションが実装されていません。
フロントエンドでのバリデーションのみで対応しています。

### 推奨事項
- Pydanticモデルの導入
- APIレベルでのバリデーション実装
- エラーレスポンスの統一化