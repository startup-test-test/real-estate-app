# ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ä»•æ§˜æ›¸

ä½œæˆæ—¥: 2025å¹´8æœˆ4æ—¥  
ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 1.0  
å¯¾è±¡: å¤§å®¶DXã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼

## ğŸ“‹ æ¦‚è¦

æœ¬æ›¸ã¯ã€å¤§å®¶DXã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãŠã‚ˆã³ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã—ã¾ã™ã€‚

## ğŸ” ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè£…ç®‡æ‰€

1. **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: `/bolt_front/src/utils/securityValidation.ts`
2. **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: `/backend/simulator-api/validations.py`

## ğŸ“Š ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åˆ¥ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«

### 1. æ–‡å­—åˆ—ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | æœ€å¤§æ–‡å­—æ•° | å¿…é ˆ | HTMLã‚¿ã‚° | å‚™è€ƒ |
|------------|-----------|------|---------|------|
| propertyNameï¼ˆç‰©ä»¶åï¼‰ | 100 | âœ… | âŒ | HTMLã‚¿ã‚°ç¦æ­¢ |
| locationï¼ˆä½æ‰€ï¼‰ | 200 | âœ… | âŒ | HTMLã‚¿ã‚°ç¦æ­¢ |
| propertyUrlï¼ˆç‰©ä»¶URLï¼‰ | 500 | - | âŒ | javascript:ç­‰ã®å±é™ºãªãƒ—ãƒ­ãƒˆã‚³ãƒ«ç¦æ­¢ |
| propertyMemoï¼ˆãƒ¡ãƒ¢ï¼‰ | 1000 | - | âŒ | HTMLã‚¿ã‚°ç¦æ­¢ |

### 2. æ•°å€¤ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆé‡‘é¡é–¢é€£ï¼‰

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | æœ€å°å€¤ | æœ€å¤§å€¤ | å˜ä½ | å‚™è€ƒ |
|------------|--------|--------|------|------|
| purchasePriceï¼ˆè³¼å…¥ä¾¡æ ¼ï¼‰ | 1 | 100,000 | ä¸‡å†† | 1ä¸‡å††ã€œ10å„„å†† |
| monthlyRentï¼ˆæœˆé¡è³ƒæ–™ï¼‰ | 0 | 100,000,000 | å†† | 0ã€œ1å„„å††/æœˆ |
| managementFeeï¼ˆç®¡ç†è²»ï¼‰ | 0 | 10,000,000 | å†† | 0ã€œ1000ä¸‡å††/æœˆ |
| propertyTaxï¼ˆå›ºå®šè³‡ç”£ç¨ï¼‰ | 0 | 5,000 | ä¸‡å†† | 0ã€œ5å„„å††/å¹´ |
| majorRepairCostï¼ˆå¤§è¦æ¨¡ä¿®ç¹•è²»ç”¨ï¼‰ | 0 | 50,000 | ä¸‡å†† | 0ã€œ50å„„å†† |
| buildingPriceForDepreciationï¼ˆå»ºç‰©ä¾¡æ ¼ï¼‰ | 0 | 100,000 | ä¸‡å†† | 0ã€œ10å„„å†† |

### 3. æ•°å€¤ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆå‰²åˆãƒ»æœŸé–“ï¼‰

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | æœ€å°å€¤ | æœ€å¤§å€¤ | å˜ä½ | å‚™è€ƒ |
|------------|--------|--------|------|------|
| downPaymentRatioï¼ˆé ­é‡‘æ¯”ç‡ï¼‰ | 0 | 100 | % | |
| interestRateï¼ˆå€Ÿå…¥é‡‘åˆ©ï¼‰ | 0 | 20 | % | |
| loanYearsï¼ˆãƒ­ãƒ¼ãƒ³æœŸé–“ï¼‰ | 1 | 50 | å¹´ | |
| holdingYearsï¼ˆä¿æœ‰å¹´æ•°ï¼‰ | 1 | 50 | å¹´ | |
| depreciationYearsï¼ˆæ¸›ä¾¡å„Ÿå´å¹´æ•°ï¼‰ | 1 | 50 | å¹´ | |

### 4. æ•°å€¤ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆé¢ç©ãƒ»ç¯‰å¹´ï¼‰

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | æœ€å°å€¤ | æœ€å¤§å€¤ | å˜ä½ | å‚™è€ƒ |
|------------|--------|--------|------|------|
| buildingAreaï¼ˆå»ºç‰©é¢ç©ï¼‰ | 1 | 100,000 | ã¡ | |
| landAreaï¼ˆåœŸåœ°é¢ç©ï¼‰ | 0 | 100,000 | ã¡ | |
| yearBuiltï¼ˆç¯‰å¹´ï¼‰ | 1900 | ç¾åœ¨å¹´+10 | å¹´ | å°†æ¥ã®ç‰©ä»¶ã‚‚è€ƒæ…® |

### 5. ç”»åƒãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰

Simulator.tsx:491  POST https://real-estate-app-rwf1.onrender.com/api/simulate 400 (Bad Request)
handleSimulation @ Simulator.tsx:491
await in handleSimulation
callCallback2 @ chunk-WRD5HZVH.js?v=fe543690:3674
invokeGuardedCallbackDev @ chunk-WRD5HZVH.js?v=fe543690:3699
invokeGuardedCallback @ chunk-WRD5HZVH.js?v=fe543690:3733
invokeGuardedCallbackAndCatchFirstError @ chunk-WRD5HZVH.js?v=fe543690:3736
executeDispatch @ chunk-WRD5HZVH.js?v=fe543690:7014
processDispatchQueueItemsInOrder @ chunk-WRD5HZVH.js?v=fe543690:7034
processDispatchQueue @ chunk-WRD5HZVH.js?v=fe543690:7043
dispatchEventsForPlugins @ chunk-WRD5HZVH.js?v=fe543690:7051
ï¼ˆåŒ¿åï¼‰ @ chunk-WRD5HZVH.js?v=fe543690:7174
batchedUpdates$1 @ chunk-WRD5HZVH.js?v=fe543690:18913
batchedUpdates @ chunk-WRD5HZVH.js?v=fe543690:3579
dispatchEventForPluginEventSystem @ chunk-WRD5HZVH.js?v=fe543690:7173
dispatchEventWithEnableCapturePhaseSelectiveHydrationWithoutDiscreteEventReplay @ chunk-WRD5HZVH.js?v=fe543690:5478
dispatchEvent @ chunk-WRD5HZVH.js?v=fe543690:5472
dispatchDiscreteEvent @ chunk-WRD5HZVH.js?v=fe543690:5449ã“ã®ã‚¨ãƒ©ãƒ¼ã‚’åˆ†æ
Simulator.tsx:637 ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼: Error: propertyNameã¯å¿…é ˆé …ç›®ã§ã™
    at handleSimulation (Simulator.tsx:516:15)
handleSimulation @ Simulator.tsx:637
await in handleSimulation
callCallback2 @ chunk-WRD5HZVH.js?v=fe543690:3674
invokeGuardedCallbackDev @ chunk-WRD5HZVH.js?v=fe543690:3699
invokeGuardedCallback @ chunk-WRD5HZVH.js?v=fe543690:3733
invokeGuardedCallbackAndCatchFirstError @ chunk-WRD5HZVH.js?v=fe543690:3736
executeDispatch @ chunk-WRD5HZVH.js?v=fe543690:7014
processDispatchQueueItemsInOrder @ chunk-WRD5HZVH.js?v=fe543690:7034
processDispatchQueue @ chunk-WRD5HZVH.js?v=fe543690:7043
dispatchEventsForPlugins @ chunk-WRD5HZVH.js?v=fe543690:7051
ï¼ˆåŒ¿åï¼‰ @ chunk-WRD5HZVH.js?v=fe543690:7174
batchedUpdates$1 @ chunk-WRD5HZVH.js?v=fe543690:18913
batchedUpdates @ chunk-WRD5HZVH.js?v=fe543690:3579
dispatchEventForPluginEventSystem @ chunk-WRD5HZVH.js?v=fe543690:7173
dispatchEventWithEnableCapturePhaseSelectiveHydrationWithoutDiscreteEventReplay @ chunk-WRD5HZVH.js?v=fe543690:5478
dispatchEvent @ chunk-WRD5HZVH.js?v=fe543690:5472
dispatchDiscreteEvent @ chunk-WRD5HZVH.js?v=fe543690:5449ã“ã®ã‚¨ãƒ©ãƒ¼ã‚’åˆ†æ
Simulator.tsx:638 ã‚¨ãƒ©ãƒ¼ã‚¹ã‚¿ãƒƒã‚¯: Error: propertyNameã¯å¿…é ˆé …ç›®ã§ã™
    at handleSimulation (https://supreme-telegram-pjw44wwvj7g6fr5v6-5173.app.github.dev/src/pages/Simulator.tsx?t=1754282754104:430:15)
## ğŸ›¡ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ¤œè¨¼

### HTMLã‚¿ã‚°æ¤œå‡ºãƒ‘ã‚¿ãƒ¼ãƒ³
```regex
/<[a-zA-Z][^>]*>|<\/[a-zA-Z][^>]*>/
```
- é–‹å§‹ã‚¿ã‚°: `<div>`, `<script>`, `<img src="...">`
- çµ‚äº†ã‚¿ã‚°: `</div>`, `</script>`
- å˜ç´”ãªä¸ç­‰å·ï¼ˆ`1 < 2`ï¼‰ã¯è¨±å¯

### å±é™ºãªURLãƒ—ãƒ­ãƒˆã‚³ãƒ«
ä»¥ä¸‹ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¯ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¾ã™ï¼š
- `javascript:`
- `data:` ï¼ˆç”»åƒã‚’é™¤ãï¼‰
- `vbscript:`
- `file:`

## ğŸ“± ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¾‹

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
```javascript
// æ•°å€¤ç¯„å›²ã‚¨ãƒ©ãƒ¼
"æœˆé¡è³ƒæ–™ï¼ˆå††ï¼‰ã¯10000000ä»¥ä¸‹ã§å…¥åŠ›ã—ã¦ãã ã•ã„"

// æ–‡å­—æ•°è¶…é
"ç‰©ä»¶åã¯100æ–‡å­—ä»¥ä¸‹ã§å…¥åŠ›ã—ã¦ãã ã•ã„"

// HTMLã‚¿ã‚°æ¤œå‡º
"ç‰©ä»¶åã«HTMLã‚¿ã‚°ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“"

// å¿…é ˆé …ç›®
"ç‰©ä»¶åã¯å¿…é ˆé …ç›®ã§ã™"
```

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆAPIï¼‰
```json
{
  "error": "å…¥åŠ›å€¤ã«ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Šã¾ã™",
  "details": [
    "purchasePriceï¼ˆä¸‡å††ï¼‰ã¯100000ä»¥ä¸‹ã§å…¥åŠ›ã—ã¦ãã ã•ã„",
    "propertyNameã«HTMLã‚¿ã‚°ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“"
  ],
  "status_code": 400
}
```

## ğŸ”„ å¸‚å ´åˆ†æAPIå°‚ç”¨ãƒ«ãƒ¼ãƒ«

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | æœ€å°å€¤ | æœ€å¤§å€¤ | å˜ä½ | å¿…é ˆ | å‚™è€ƒ |
|------------|--------|--------|------|------|------|
| location | - | 200æ–‡å­— | - | âœ… | HTMLã‚¿ã‚°ç¦æ­¢ |
| land_area | 0 | 100,000 | ã¡ | âœ… | |
| year_built | 1900 | ç¾åœ¨å¹´+10 | å¹´ | âœ… | |
| purchase_price | 1 | 100,000 | ä¸‡å†† | âœ… | |

## âš ï¸ æ³¨æ„äº‹é …

1. **å˜ä½ã®çµ±ä¸€æ€§**
   - é‡‘é¡ã¯åŸºæœ¬çš„ã«ã€Œä¸‡å††ã€å˜ä½
   - ãŸã ã—ã€æœˆé¡è³ƒæ–™ã¨ç®¡ç†è²»ã¯ã€Œå††ã€å˜ä½
   - UIã«è¡¨ç¤ºã•ã‚Œã‚‹å˜ä½ã¨ä¸€è‡´ã•ã›ã‚‹ã“ã¨

2. **æœ€å¤§å€¤ã®è¨­å®šæ ¹æ‹ **
   - è³¼å…¥ä¾¡æ ¼: 10å„„å††ï¼ˆé«˜é¡ç‰©ä»¶å¯¾å¿œï¼‰
   - æœˆé¡è³ƒæ–™: 1å„„å††/æœˆï¼ˆè¶…é«˜ç´šç‰©ä»¶ãƒ»å•†æ¥­ãƒ“ãƒ«å¯¾å¿œï¼‰
   - ç®¡ç†è²»: 1000ä¸‡å††/æœˆï¼ˆå¤§è¦æ¨¡ç‰©ä»¶å¯¾å¿œï¼‰
   - ä¿æœ‰å¹´æ•°: 50å¹´ï¼ˆé•·æœŸä¿æœ‰å¯¾å¿œï¼‰

3. **ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®é †åº**
   1. å¿…é ˆãƒã‚§ãƒƒã‚¯
   2. å‹ãƒã‚§ãƒƒã‚¯ï¼ˆæ•°å€¤/æ–‡å­—åˆ—ï¼‰
   3. ç¯„å›²/é•·ã•ãƒã‚§ãƒƒã‚¯
   4. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ï¼ˆHTMLã‚¿ã‚°ã€URLï¼‰

## ğŸ“ æ›´æ–°å±¥æ­´

| æ—¥ä»˜ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å†…å®¹ |
|------|-----------|------|
| 2025/08/04 | 1.0 | åˆç‰ˆä½œæˆ |
| 2025/08/04 | 1.1 | monthlyRent, managementFeeã®å˜ä½ã‚’å††ã«ä¿®æ­£ |
| 2025/08/04 | 1.2 | monthlyRentä¸Šé™ã‚’1å„„å††ã€managementFeeä¸Šé™ã‚’1000ä¸‡å††ã«æ‹¡å¼µ |

---
æœ€çµ‚æ›´æ–°: 2025å¹´8æœˆ4æ—¥