# 開発環境用 .htaccess

# デフォルトファイル
DirectoryIndex index.html index.php

# SPAのルーティング設定
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /
    RewriteRule ^index\.html$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.html [L]
</IfModule>

# HTTPSへのリダイレクト
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

# セキュリティ設定
<Files ~ "^\.env">
    Order allow,deny
    Deny from all
</Files>

# セキュリティヘッダー
Header set X-Content-Type-Options "nosniff"
Header set X-Frame-Options "SAMEORIGIN"
Header set X-XSS-Protection "1; mode=block"

# キャッシュ制御（開発環境用）
<FilesMatch "\.(html|htm|js|css|json)$">
    Header set Cache-Control "no-cache, no-store, must-revalidate"
    Header set Pragma "no-cache"
    Header set Expires 0
</FilesMatch>

# 画像ファイルは1日キャッシュ
<FilesMatch "\.(jpg|jpeg|png|gif|ico|svg)$">
    Header set Cache-Control "max-age=86400, public"
</FilesMatch>

# アクセス許可
<RequireAll>
    Require all granted
</RequireAll>

# Basic認証（開発環境保護）
# 正しいパスを確認してから有効化してください
# AuthType Basic
# AuthName "Development Site"
# AuthUserFile /home/[サーバーID]/ooya.tech/public_html/dev.ooya.tech/.htpasswd
# Require valid-user