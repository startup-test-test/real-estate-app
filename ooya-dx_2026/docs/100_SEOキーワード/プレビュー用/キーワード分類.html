
No	区分	キーワード	SEO難易度	月間検索数	判定	検索意図	トピック
<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>キーワード分類ビューア</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; background: #f0f2f5; color: #1a1a1a; }
  .header { background: #1e293b; color: #fff; padding: 12px 20px; display: flex; align-items: center; gap: 16px; position: sticky; top: 0; z-index: 10; }
  .header h1 { font-size: 16px; white-space: nowrap; }
  .header .updated { font-size: 11px; color: #94a3b8; margin-left: auto; }
  .container { display: flex; height: calc(100vh - 44px); }

  /* サイドバー */
  .sidebar { width: 280px; min-width: 280px; background: #fff; border-right: 1px solid #e2e8f0; overflow-y: auto; padding: 8px 0; }
  .sidebar-item { padding: 8px 14px; cursor: pointer; font-size: 12px; border-left: 3px solid transparent; display: flex; justify-content: space-between; align-items: center; }
  .sidebar-item:hover { background: #f1f5f9; }
  .sidebar-item.active { background: #eff6ff; border-left-color: #2563eb; font-weight: 600; }
  .sidebar-item .count { font-size: 10px; color: #94a3b8; }
  .sidebar-search { padding: 8px 12px; border-bottom: 1px solid #e2e8f0; }
  .sidebar-search input { width: 100%; padding: 6px 8px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 12px; }

  /* メインコンテンツ */
  .main { flex: 1; overflow: auto; padding: 16px; }
  .stats { display: flex; gap: 12px; margin-bottom: 12px; flex-wrap: wrap; }
  .stat-card { background: #fff; border-radius: 6px; padding: 10px 16px; box-shadow: 0 1px 2px rgba(0,0,0,0.06); min-width: 120px; }
  .stat-card .label { font-size: 11px; color: #64748b; }
  .stat-card .value { font-size: 20px; font-weight: 700; }
  .stat-card.calc .value { color: #16a34a; }
  .stat-card.article .value { color: #2563eb; }
  .stat-card.delete .value { color: #9ca3af; }
  .stat-card.total .value { color: #1e293b; }

  /* フィルター */
  .filters { display: flex; gap: 6px; margin-bottom: 12px; flex-wrap: wrap; }
  .filter-btn { padding: 4px 12px; border: 1px solid #d1d5db; border-radius: 20px; font-size: 11px; cursor: pointer; background: #fff; }
  .filter-btn:hover { background: #f1f5f9; }
  .filter-btn.active { background: #1e293b; color: #fff; border-color: #1e293b; }

  /* テーブル */
  table { border-collapse: collapse; font-size: 12px; background: #fff; box-shadow: 0 1px 3px rgba(0,0,0,0.08); width: 100%; border-radius: 6px; overflow: hidden; }
  th { background: #1e293b; color: #fff; padding: 8px 10px; text-align: left; position: sticky; top: 0; white-space: nowrap; font-weight: 500; font-size: 11px; }
  td { border-bottom: 1px solid #f1f5f9; padding: 6px 10px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; }
  tr:hover { background: #f8fafc; }

  /* 判定スタイル */
  tr.row-calc { border-left: 3px solid #16a34a; }
  tr.row-article { border-left: 3px solid #2563eb; }
  tr.row-delete { border-left: 3px solid #e5e7eb; opacity: 0.5; }
  .badge { display: inline-block; padding: 2px 8px; border-radius: 3px; font-size: 10px; font-weight: 600; }
  .badge-calc { background: #dcfce7; color: #166534; }
  .badge-article { background: #dbeafe; color: #1e40af; }
  .badge-delete { background: #f3f4f6; color: #9ca3af; }

  .empty { text-align: center; padding: 60px; color: #94a3b8; font-size: 14px; }
  .kw-search { margin-bottom: 12px; }
  .kw-search input { padding: 6px 10px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 12px; width: 300px; }
</style>
</head>
<body>
<div class="header">
  <h1>キーワード分類ビューア</h1>
  <span class="updated" id="updated"></span>
</div>
<div class="container">
  <div class="sidebar">
    <div class="sidebar-search">
      <input type="text" id="fileSearch" placeholder="ファイル検索..." oninput="filterFiles()">
    </div>
    <div id="fileList"></div>
  </div>
  <div class="main" id="main">
    <div class="empty">左のリストからファイルを選択してください</div>
  </div>
</div>

<script>
let allFiles = [];
let currentData = [];
let currentFilter = 'all';

function loadFileList() {
  allFiles = [
    'DCF法_判定済み.tsv','DSCR_判定済み.tsv','IRR_判定済み.tsv','NOI_判定済み.tsv','NPV_判定済み.tsv',
    'キャッシュフロー_判定済み.tsv','デッドクロス_判定済み.tsv','リフォームローン_判定済み.tsv','リフォーム費用_判定済み.tsv',
    '印紙税_判定済み.tsv','繰上返済_判定済み.tsv','建物消費税_判定済み.tsv','減価償却_判定済み.tsv',
    '個人事業税_判定済み.tsv','固定資産税_判定済み.tsv','固定資産税精算金_判定済み.tsv',
    '再調達価格_判定済み.tsv','自己資金配当率_判定済み.tsv','実質利回り_判定済み.tsv',
    '借入可能額_判定済み.tsv','借入比率_判定済み.tsv','収益還元_判定済み.tsv',
    '住宅ローン_判定済み.tsv','住民税_判定済み.tsv','所得税_判定済み.tsv','譲渡所得税_判定済み.tsv',
    '正味現在価値_判定済み.tsv','積算評価_判定済み.tsv','相続税_判定済み.tsv','贈与税_判定済み.tsv',
    '仲介手数料_判定済み.tsv','登録免許税_判定済み.tsv','投資利益率_判定済み.tsv','内部収益率_判定済み.tsv',
    '売却_判定済み.tsv','表面利回り_判定済み.tsv','不動産取得税_判定済み.tsv','不動産投資_判定済み.tsv',
    '不動産投資計算_判定済み.tsv','不動産売却_判定済み.tsv','法人税_判定済み.tsv'
  ];
  allFiles.sort((a, b) => a.localeCompare(b, 'ja'));
  renderFileList();
}

function renderFileList(filter = '') {
  const container = document.getElementById('fileList');
  let html = '';
  allFiles.forEach((f, idx) => {
    const name = f.replace('_判定済み.tsv', '');
    if (filter && !name.includes(filter)) return;
    html += '<div class="sidebar-item" data-idx="' + idx + '" onclick="loadFileByIdx(' + idx + ', this)" title="' + name + '">' +
            '<span>' + name + '</span>' +
            '</div>';
  });
  container.innerHTML = html || '<div style="padding:12px;color:#94a3b8;font-size:12px">該当なし</div>';
}

function loadFileByIdx(idx, el) {
  loadFile(allFiles[idx], el);
}

function filterFiles() {
  renderFileList(document.getElementById('fileSearch').value);
}

async function loadFile(rawFilename, el) {
  const filename = rawFilename;
  // Active state
  document.querySelectorAll('.sidebar-item').forEach(e => e.classList.remove('active'));
  if (el) el.classList.add('active');

  try {
    const basePath = decodeURIComponent(location.pathname).includes('/プレビュー用/') ? '../キーワード分類/' : 'キーワード分類/';
    const res = await fetch(basePath + encodeURIComponent(filename) + '?t=' + Date.now());
    const text = await res.text();
    const rows = text.trim().split('\n').map(r => r.split('\t'));
    currentData = rows;
    currentFilter = 'all';
    currentFilename = filename;
    renderTable(rows, filename);
    document.getElementById('updated').textContent = '最終読込: ' + new Date().toLocaleString('ja-JP');
  } catch (e) {
    document.getElementById('main').innerHTML = '<div class="empty">読み込みに失敗しました: ' + filename + '</div>';
  }
}

function renderTable(rows, filename) {
  if (rows.length < 2) {
    document.getElementById('main').innerHTML = '<div class="empty">データなし</div>';
    return;
  }
  const header = rows[0];
  const data = rows.slice(1).filter(r => r.length >= 6);
  const name = decodeURIComponent(filename).replace('_判定済み.tsv', '');

  // Stats
  let calcCount = 0, articleCount = 0, deleteCount = 0;
  let totalVol = 0, calcVol = 0;
  data.forEach(r => {
    const 判定 = (r[5] || '').trim();
    const vol = parseInt(r[4]) || 0;
    if (判定 === '計算ページ') { calcCount++; calcVol += vol; }
    else if (判定 === '記事') { articleCount++; }
    else if (判定 === '削除') { deleteCount++; }
    if (判定 !== '削除') totalVol += vol;
  });

  // Filter data
  let filtered = data;
  if (currentFilter === 'calc') filtered = data.filter(r => (r[5]||'').trim() === '計算ページ');
  else if (currentFilter === 'article') filtered = data.filter(r => (r[5]||'').trim() === '記事');
  else if (currentFilter === 'delete') filtered = data.filter(r => (r[5]||'').trim() === '削除');

  // Keyword filter
  const kwFilter = document.getElementById('kwSearch') ? document.getElementById('kwSearch').value : '';
  if (kwFilter) {
    filtered = filtered.filter(r => (r[2]||'').includes(kwFilter));
  }

  let html = '';
  // Stats
  html += '<div class="stats">';
  html += '<div class="stat-card total"><div class="label">合計キーワード</div><div class="value">' + data.length + '</div></div>';
  html += '<div class="stat-card calc"><div class="label">計算ページ</div><div class="value">' + calcCount + '</div></div>';
  html += '<div class="stat-card article"><div class="label">記事</div><div class="value">' + articleCount + '</div></div>';
  html += '<div class="stat-card delete"><div class="label">削除</div><div class="value">' + deleteCount + '</div></div>';
  html += '</div>';

  // Filters
  html += '<div class="filters">';
  html += '<div class="filter-btn' + (currentFilter==='all'?' active':'') + '" onclick="setFilter(\'all\')">すべて (' + data.length + ')</div>';
  html += '<div class="filter-btn' + (currentFilter==='calc'?' active':'') + '" onclick="setFilter(\'calc\')">計算ページ (' + calcCount + ')</div>';
  html += '<div class="filter-btn' + (currentFilter==='article'?' active':'') + '" onclick="setFilter(\'article\')">記事 (' + articleCount + ')</div>';
  html += '<div class="filter-btn' + (currentFilter==='delete'?' active':'') + '" onclick="setFilter(\'delete\')">削除 (' + deleteCount + ')</div>';
  html += '</div>';

  // Keyword search
  html += '<div class="kw-search"><input type="text" id="kwSearch" placeholder="キーワード検索..." oninput="rerender()" value="' + (kwFilter||'') + '"></div>';

  // Table
  html += '<table><tr>';
  header.forEach(h => { html += '<th>' + h + '</th>'; });
  html += '</tr>';

  filtered.forEach(row => {
    const 判定 = (row[5] || '').trim();
    let cls = '';
    if (判定 === '計算ページ') cls = 'row-calc';
    else if (判定 === '記事') cls = 'row-article';
    else if (判定 === '削除') cls = 'row-delete';

    html += '<tr class="' + cls + '">';
    row.forEach((cell, j) => {
      cell = (cell||'').trim();
      let display = cell.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');

      // 判定列にバッジ
      if (j === 5) {
        if (cell === '計算ページ') display = '<span class="badge badge-calc">' + display + '</span>';
        else if (cell === '記事') display = '<span class="badge badge-article">' + display + '</span>';
        else if (cell === '削除') display = '<span class="badge badge-delete">' + display + '</span>';
      }
      // 月間検索数をフォーマット
      if (j === 4 && !isNaN(cell) && cell !== '') {
        display = Number(cell).toLocaleString();
      }
      html += '<td>' + display + '</td>';
    });
    html += '</tr>';
  });
  html += '</table>';
  html += '<div style="padding:8px;font-size:11px;color:#94a3b8">表示: ' + filtered.length + '件 / ' + data.length + '件</div>';

  document.getElementById('main').innerHTML = html;
}

function setFilter(f) {
  currentFilter = f;
  rerender();
}

let currentFilename = '';

function rerender() {
  if (currentData.length > 0 && currentFilename) {
    renderTable(currentData, currentFilename);
  }
}

loadFileList();
</script>
</body>
</html>
