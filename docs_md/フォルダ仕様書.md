# プロジェクトフォルダ仕様書

作成日: 2025年8月15日  
プロジェクト名: 大家DX - 不動産投資収益シミュレーター

---

## 📁 プロジェクト全体構造

```
/workspaces/real-estate-app/
├── bolt_front/          # フロントエンドアプリケーション
├── backend/             # バックエンドAPI
├── supabase/            # Supabase設定・関数
├── docs_md/             # プロジェクトドキュメント
├── server-configs/      # サーバー設定（Apache）
├── scripts/             # ユーティリティスクリプト
├── 参考キャプチャー/      # 参考画像・スクリーンショット
└── README.md            # プロジェクト概要
```

---

## 🎨 bolt_front/ - フロントエンドアプリケーション

### 概要
React + TypeScript + Viteで構築されたSPAアプリケーション

### 主要ディレクトリ

| ディレクトリ | 用途 | ステータス | 重要度 |
|------------|------|----------|--------|
| **src/** | ソースコード | ✅使用中 | 必須 |
| ├── components/ | 再利用可能なUIコンポーネント | ✅使用中 | 必須 |
| ├── pages/ | ページコンポーネント | ✅使用中 | 必須 |
| ├── hooks/ | カスタムReactフック | ✅使用中 | 必須 |
| ├── utils/ | ユーティリティ関数 | ✅使用中 | 必須 |
| ├── types/ | TypeScript型定義 | ✅使用中 | 必須 |
| ├── lib/ | 外部ライブラリ設定 | ✅使用中 | 必須 |
| ├── config/ | アプリケーション設定 | ✅使用中 | 必須 |
| ├── constants/ | 定数定義 | ✅使用中 | 必須 |
| ├── tests/ | テストファイル | ✅使用中 | 重要 |
| **dist/** | ビルド出力 | ✅自動生成 | 本番必須 |
| **node_modules/** | npm依存関係 | ✅自動生成 | 必須 |
| **img/** | 静的画像ファイル | ✅使用中 | 必須 |

### 主要ファイル

| ファイル | 説明 | ステータス |
|---------|------|-----------|
| package.json | npm設定・依存関係 | ✅必須 |
| vite.config.ts | Viteビルド設定 | ✅必須 |
| tsconfig.json | TypeScript設定 | ✅必須 |
| tailwind.config.js | Tailwind CSS設定 | ✅必須 |
| index.html | エントリーHTML | ✅必須 |
| .env | 環境変数（Gitignore） | ⚠️要設定 |

---

## 🔧 backend/ - バックエンドAPI

### 構成

```
backend/
├── property-api/        # 不動産物件情報API
│   ├── real_estate_client.py
│   ├── streamlit_app.py
│   └── requirements.txt
└── simulator-api/       # シミュレーションAPI
    ├── app.py          # メインAPIサーバー
    ├── validations.py  # バリデーション
    ├── error_codes.py  # エラーコード定義
    ├── shared/         # 共有計算ロジック
    └── tests/          # テストスイート
```

### ステータス

| API | 用途 | ステータス | デプロイ先 |
|-----|------|----------|-----------|
| property-api | 物件情報取得 | ⚠️開発中 | 未デプロイ |
| simulator-api | シミュレーション計算 | ✅稼働中 | Render |

---

## 🗄️ supabase/ - Supabase設定

### ディレクトリ構成

| ディレクトリ | 説明 | ステータス | 重要度 |
|------------|------|----------|--------|
| **functions/** | Edge Functions | ✅稼働中 | 必須 |
| ├── create-checkout-session/ | Stripe決済セッション作成 | ✅実装済 | 必須 |
| ├── handle-stripe-webhook/ | Stripe Webhook処理 | ✅実装済 | 必須 |
| ├── cancel-subscription/ | サブスクリプション解約 | ✅実装済 | 必須 |
| └── resume-subscription/ | サブスクリプション再開 | ✅実装済 | 必須 |
| **migrations/** | DBマイグレーション | ✅適用済 | 必須 |
| **policies/** | RLSポリシー | ✅設定済 | 必須 |
| **archive/** | アーカイブ済みSQL | 📦保管 | 参考 |

### 主要マイグレーション

| ファイル | 内容 | ステータス |
|---------|------|-----------|
| 001_initial_schema.sql | 初期スキーマ | ✅適用済 |
| 002_properties_table.sql | 物件テーブル | ✅適用済 |
| 20240812_stripe_tables.sql | Stripe連携テーブル | ✅適用済 |
| 20250813_add_cancel_subscription_fields.sql | 解約フィールド | ✅適用済 |
| 20250814_add_unique_subscription_constraint.sql | ユニーク制約 | ✅適用済 |

---

## 📚 docs_md/ - ドキュメント

### カテゴリ別ディレクトリ

| ディレクトリ | 内容 | ステータス | 重要度 |
|------------|------|----------|--------|
| **01_要件定義/** | 要件・仕様書 | ✅活用中 | 重要 |
| **02_日報/** | 開発日報・作業記録 | ✅更新中 | 参考 |
| **03_リファクタリング/** | リファクタリング計画 | 📋計画中 | 中 |
| **04_コメント共有機能/** | 共有機能仕様 | ⏸️保留 | 低 |
| **05_不動産情報ライブラリ連携/** | API連携仕様 | ⏸️保留 | 低 |
| **06_シミュレーター機能/** | シミュレーター仕様 | ✅活用中 | 高 |
| **07_セキュリティ対策/** | セキュリティ関連 | ✅重要 | 必須 |
| **08_シナリオテスト/** | テストシナリオ | ✅活用中 | 重要 |
| **10_ログイン機能/** | 認証システム | ✅実装済 | 必須 |
| **11_サブスクリプション管理/** | 課金システム | ✅実装済 | 必須 |
| **12_法務・宅建法/** | 法的要件 | ✅確認済 | 必須 |
| **98_環境変数/** | 環境設定ガイド | ⚠️要更新 | 必須 |
| **99_アーカイブ/** | 過去の実装 | 📦保管 | 参考 |
| **99_サーバーにアップロード方法/** | デプロイ手順 | ✅活用中 | 重要 |
| **100_何度も起きるエラー原因/** | トラブルシューティング | ✅活用中 | 参考 |

### 重要ドキュメント

| ファイル | 説明 | ステータス | 更新頻度 |
|---------|------|----------|----------|
| **本番リリースチェックリスト.md** | リリース管理 | ✅活用中 | 毎週 |
| **フォルダ仕様書.md** | 本ドキュメント | ✅作成済 | 随時 |

---

## 🚀 server-configs/ - サーバー設定

### 概要
GitHub Actionsによる自動デプロイで使用されるApache設定ファイル

### ステータス
✅ **アクティブに使用中**（GitHub Actions連携）

### 構成
```
server-configs/
├── dev/          # 開発環境用（dev.ooya.tech）
└── main/         # 本番環境用（ooya.tech）
```

### 重要度
**必須** - 削除するとデプロイが失敗します

### GitHub連携
- `.github/workflows/deploy-to-xserver-dev.yml`
- `.github/workflows/deploy-to-xserver.yml`
- `.github/workflows/manual-deploy.yml`

**注意**: 現在、Apache設定（.htaccess）をGitHub Actions経由でXserverに配置
- Frontend: Vercel/Netlify設定予定
- Backend: Render（render.yaml）
- Database: Supabase Dashboard

---

## 🛠️ scripts/ - ユーティリティスクリプト

| スクリプト | 用途 | ステータス |
|-----------|------|-----------|
| apply-migrations.sh | DBマイグレーション適用 | ✅動作 |
| deploy-to-xserver.sh | Xサーバーデプロイ | ⚠️要更新 |

---

## 🖼️ 参考キャプチャー/

競合サービスのUI/UX参考画像（楽町など）
- 計18ファイル
- 開発参考用
- ステータス: 📋参考資料

---

## 🔴 削除可能なディレクトリ・ファイル

### 安全に削除可能
1. **docs_md/99_アーカイブ/** - 過去の実装（バックアップ後）
3. **参考キャプチャー/** - 必要に応じて外部保管

### 統合・整理推奨
1. **docs_md/04_コメント共有機能/** → 機能保留のため圧縮保管
2. **docs_md/05_不動産情報ライブラリ連携/** → 機能保留のため圧縮保管
3. **backend/property-api/** → 未使用の場合、別リポジトリへ

---

## 📊 ディスク使用量（推定）

| カテゴリ | サイズ | 割合 |
|---------|--------|------|
| node_modules | ~300MB | 70% |
| ソースコード | ~50MB | 12% |
| ドキュメント | ~30MB | 7% |
| 画像・アセット | ~20MB | 5% |
| その他 | ~25MB | 6% |
| **合計** | **~425MB** | **100%** |

---

## ⚠️ 注意事項

### Gitignoreすべきファイル
- `.env` - 環境変数
- `node_modules/` - npm依存関係
- `dist/` - ビルド成果物
- `.DS_Store` - macOSシステムファイル
- `*.log` - ログファイル

### バックアップ推奨
- `/supabase/migrations/` - DBスキーマ
- `/docs_md/本番リリースチェックリスト.md` - 進捗管理
- `/bolt_front/src/` - ソースコード

### セキュリティ注意
- 環境変数は絶対にコミットしない
- APIキーは環境変数で管理
- 本番用秘密鍵は別途管理

---

## 🎯 推奨アクション

1. **即座に実施**
   - [ ] .env.exampleファイルの作成
   - [ ] 不要なアーカイブの削除
   - [ ] デプロイ設定の整理

2. **1週間以内**
   - [ ] ドキュメントの整理統合
   - [ ] テストカバレッジの確認
   - [ ] 環境変数の文書化

3. **1ヶ月以内**
   - [ ] 未使用コードの削除
   - [ ] パフォーマンス最適化
   - [ ] セキュリティ監査

---

*このドキュメントは定期的に更新し、プロジェクト構造の変更を反映させてください。*