# シミュレーター機能 検証項目シート

作成日: 2025-08-31  
バージョン: 1.0.0

## 1. 機能概要

不動産投資収益シミュレーター機能は、物件情報と融資条件を入力して投資収益性を分析する中核機能です。
IRR、CCR、DSCR等の投資指標を計算し、キャッシュフロー表を生成します。

## 2. 検証項目

### 2.1 入力フォーム検証

| No | 検証項目 | 検証内容 | 期待結果 | 優先度 | 状態 |
|----|---------|---------|---------|--------|------|
| F001 | 必須項目チェック | 必須項目を空欄で実行 | エラーメッセージ表示 | 高 | [ ] |
| F002 | 数値範囲チェック（購入価格） | 100万円未満、10億円超を入力 | 範囲エラー表示 | 高 | [ ] |
| F003 | 数値範囲チェック（金利） | 0%、20%超を入力 | 範囲エラー表示 | 高 | [ ] |
| F004 | 数値範囲チェック（返済期間） | 0年、50年超を入力 | 範囲エラー表示 | 高 | [ ] |
| F005 | 文字列入力（数値項目） | 数値項目に文字列入力 | 数値のみ入力可能 | 高 | [ ] |
| F006 | 小数点入力 | 金利に小数点2桁以上入力 | 適切に処理 | 中 | [ ] |
| F007 | マイナス値入力 | 各項目にマイナス値入力 | エラーまたは0に変換 | 高 | [ ] |
| F008 | 借入額と購入価格の整合性 | 借入額＞購入価格で入力 | 警告メッセージ表示 | 中 | [ ] |
| F009 | 特殊文字入力（物件名） | 物件名に特殊文字入力 | サニタイズ処理 | 中 | [ ] |
| F010 | 最大文字数チェック | 各テキスト項目に最大文字数超入力 | 文字数制限エラー | 中 | [ ] |

### 2.2 計算ロジック検証

| No | 検証項目 | 検証内容 | 期待結果 | 優先度 | 状態 |
|----|---------|---------|---------|--------|------|
| C001 | 表面利回り計算 | 年間家賃収入÷購入価格×100 | 正しい計算結果 | 高 | [ ] |
| C002 | NOI計算 | 実効家賃収入－年間経費 | 正しい計算結果 | 高 | [ ] |
| C003 | CCR計算 | (年間CF－年間返済)÷自己資金×100 | 正しい計算結果 | 高 | [ ] |
| C004 | DSCR計算 | NOI÷年間返済額 | 正しい計算結果 | 高 | [ ] |
| C005 | 元利均等返済計算 | 月額返済額の計算 | 正しい返済額 | 高 | [ ] |
| C006 | 元金均等返済計算 | 月額返済額の計算 | 正しい返済額 | 高 | [ ] |
| C007 | 空室率反映 | 空室率を考慮した収入計算 | 正しい実効収入 | 高 | [ ] |
| C008 | 家賃下落率反映 | 年次ごとの家賃下落計算 | 正しい下落後家賃 | 高 | [ ] |
| C009 | 積算評価計算 | 土地評価＋建物評価 | 正しい積算評価額 | 中 | [ ] |
| C010 | IRR近似計算 | 内部収益率の計算 | 妥当な近似値 | 中 | [ ] |

### 2.3 キャッシュフロー表検証

| No | 検証項目 | 検証内容 | 期待結果 | 優先度 | 状態 |
|----|---------|---------|---------|--------|------|
| CF001 | 年次データ生成 | 保有年数分のデータ生成 | 指定年数分の行表示 | 高 | [ ] |
| CF002 | 累計CF計算 | 各年の累計キャッシュフロー | 正しい累計値 | 高 | [ ] |
| CF003 | 家賃下落反映 | 年次ごとの家賃下落 | 各年で減少確認 | 高 | [ ] |
| CF004 | 大規模修繕計上 | 指定年での修繕費計上 | 該当年に反映 | 中 | [ ] |
| CF005 | 残債計算 | 年次ごとの残債減少 | 正しい残債推移 | 高 | [ ] |
| CF006 | 売却シミュレーション | 最終年の売却益計算 | 正しい売却益 | 中 | [ ] |
| CF007 | 表示フォーマット | 金額の3桁区切り表示 | 見やすい表示形式 | 低 | [ ] |
| CF008 | CSVエクスポート | データのCSV出力 | 正常にダウンロード | 低 | [ ] |

### 2.4 UI/UX検証

| No | 検証項目 | 検証内容 | 期待結果 | 優先度 | 状態 |
|----|---------|---------|---------|--------|------|
| U001 | レスポンシブ対応 | スマートフォンでの表示 | 適切なレイアウト | 高 | [ ] |
| U002 | タブレット表示 | タブレットでの表示 | 適切なレイアウト | 中 | [ ] |
| U003 | 入力値保持 | ページ遷移後に戻る | 入力値が保持 | 中 | [ ] |
| U004 | ローディング表示 | 計算中の表示 | スピナー表示 | 中 | [ ] |
| U005 | エラー表示位置 | エラーメッセージの表示位置 | 該当項目近くに表示 | 中 | [ ] |
| U006 | ツールチップ | 各項目のヘルプ表示 | 説明文表示 | 低 | [ ] |
| U007 | グラフ表示 | キャッシュフローのグラフ | 正しくレンダリング | 中 | [ ] |
| U008 | 印刷プレビュー | 結果の印刷表示 | 適切なレイアウト | 低 | [ ] |

### 2.5 パフォーマンス検証

| No | 検証項目 | 検証内容 | 期待結果 | 優先度 | 状態 |
|----|---------|---------|---------|--------|------|
| P001 | 計算速度 | 通常データでの計算時間 | 3秒以内 | 高 | [ ] |
| P002 | 大量データ処理 | 50年シミュレーション | 5秒以内 | 中 | [ ] |
| P003 | 同時実行 | 複数ユーザー同時実行 | 正常に処理 | 高 | [ ] |
| P004 | メモリ使用量 | 長時間使用時のメモリ | メモリリークなし | 中 | [ ] |
| P005 | API応答時間 | バックエンドAPI応答 | 1秒以内 | 高 | [ ] |

### 2.6 利用制限検証

| No | 検証項目 | 検証内容 | 期待結果 | 優先度 | 状態 |
|----|---------|---------|---------|--------|------|
| L001 | 無料プラン制限 | 月5回実行後の6回目 | アップグレード画面表示 | 高 | [ ] |
| L002 | 利用回数カウント | 実行ごとのカウント増加 | 正しくカウント | 高 | [ ] |
| L003 | リセット機能 | 30日後の自動リセット | カウントリセット | 高 | [ ] |
| L004 | プレミアムプラン | 有料プランでの無制限実行 | 制限なし | 高 | [ ] |
| L005 | 利用状況表示 | 残り回数の表示 | 正しい残数表示 | 中 | [ ] |

### 2.7 データ保存・読込検証

| No | 検証項目 | 検証内容 | 期待結果 | 優先度 | 状態 |
|----|---------|---------|---------|--------|------|
| S001 | シミュレーション保存 | 結果の保存 | DBに正しく保存 | 高 | [ ] |
| S002 | 履歴一覧表示 | 過去の結果一覧 | 正しく表示 | 高 | [ ] |
| S003 | 詳細表示 | 保存済み結果の詳細表示 | 完全なデータ表示 | 高 | [ ] |
| S004 | 削除機能 | 保存済みデータ削除 | 正しく削除 | 中 | [ ] |
| S005 | 編集・再計算 | 保存データを編集して再計算 | 新規として保存 | 中 | [ ] |

## 3. テストシナリオ

### シナリオ1: 一般的な区分マンション投資
- 購入価格: 2,000万円
- 借入額: 1,800万円
- 金利: 2.5%
- 返済期間: 35年
- 月額賃料: 10万円
- 空室率: 5%

### シナリオ2: 一棟アパート投資
- 購入価格: 8,000万円
- 借入額: 7,200万円
- 金利: 3.0%
- 返済期間: 30年
- 月額賃料: 50万円
- 空室率: 10%

### シナリオ3: 現金購入
- 購入価格: 1,500万円
- 借入額: 0円
- 月額賃料: 8万円
- 空室率: 5%

## 4. 検証結果サマリー

| 分類 | 総項目数 | 完了 | 未完了 | 完了率 |
|------|---------|------|--------|--------|
| 入力フォーム | 10 | 0 | 10 | 0% |
| 計算ロジック | 10 | 0 | 10 | 0% |
| キャッシュフロー表 | 8 | 0 | 8 | 0% |
| UI/UX | 8 | 0 | 8 | 0% |
| パフォーマンス | 5 | 0 | 5 | 0% |
| 利用制限 | 5 | 0 | 5 | 0% |
| データ保存 | 5 | 0 | 5 | 0% |
| **合計** | **51** | **0** | **51** | **0%** |

## 5. 既知の問題

- IRR計算は簡易近似式を使用（正確な計算は今後実装予定）
- 大規模修繕の自動計算機能は未実装
- 税金計算（減価償却等）は簡略化

## 6. 備考

- バックエンドAPIはFastAPIで実装
- フロントエンドはReact + TypeScript
- 計算ロジックの検証には専門知識が必要

## 7. 更新履歴

| 日付 | バージョン | 更新内容 |
|------|-----------|---------|
| 2025-08-31 | 1.0.0 | 初版作成 |