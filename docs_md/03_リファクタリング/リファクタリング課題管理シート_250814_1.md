# リファクタリング課題管理シート

**作成日**: 2025年8月14日  
**作成者**: 開発チーム  
**対象**: プロジェクトルート直下の不要ファイル整理

## 📋 概要

プロジェクトルート直下に散在している一時的なテスト・デバッグファイルを整理し、プロジェクト構造をクリーンに保つためのリファクタリング作業。

## 🎯 目的

1. プロジェクトルートの整理整頓
2. 不要なテストファイルの削除
3. メンテナンス性の向上
4. 開発環境のクリーン化

## 📊 削除対象ファイル一覧（19ファイル）

### SQLファイル（8ファイル）

| No | ファイル名 | 用途 | 作成時期 | 削除理由 | ステータス |
|----|-----------|------|----------|----------|-----------|
| 1 | `check_subscription_data.sql` | サブスクリプションデータ確認 | 8月中旬 | テスト用、不要 | ⏳ 未削除 |
| 2 | `check_table_structure.sql` | テーブル構造確認 | 8月中旬 | デバッグ用、不要 | ⏳ 未削除 |
| 3 | `debug_subscription.sql` | サブスクリプションデバッグ | 8月中旬 | デバッグ完了 | ⏳ 未削除 |
| 4 | `fix_subscription_id.sql` | ID修正用 | 8月中旬 | 一時的な修正、完了済み | ⏳ 未削除 |
| 5 | `insert_subscription.sql` | テストデータ挿入 | 8月中旬 | テスト完了 | ⏳ 未削除 |
| 6 | `reset_premium_correct.sql` | プレミアム解約（修正版） | 8/14 | 本日作成、テスト完了 | ⏳ 未削除 |
| 7 | `reset_premium_for_user.sql` | プレミアム解約（初版） | 8/14 | 本日作成、不要 | ⏳ 未削除 |
| 8 | `update_subscription_with_real_id.sql` | ID更新 | 8月中旬 | 一時的な修正、完了済み | ⏳ 未削除 |

### TypeScript/JavaScriptファイル（2ファイル）

| No | ファイル名 | 用途 | 作成時期 | 削除理由 | ステータス |
|----|-----------|------|----------|----------|-----------|
| 9 | `edge_function_debug.ts` | Edge Functionデバッグ | 8/14 | 本日作成、デバッグ完了 | ⏳ 未削除 |
| 10 | `final_edge_function.ts` | Edge Function最終版 | 8/14 | 本日作成、デプロイ済み | ⏳ 未削除 |

### シェルスクリプト（5ファイル）

| No | ファイル名 | 用途 | 作成時期 | 削除理由 | ステータス |
|----|-----------|------|----------|----------|-----------|
| 11 | `deploy_create_checkout_session.sh` | 個別デプロイ | 8/14 | 本日作成、一時的 | ⏳ 未削除 |
| 12 | `deploy_edge_functions.sh` | Edge Functionsデプロイ | 8月中旬 | 一時的なスクリプト | ⏳ 未削除 |
| 13 | `deploy_resume.sh` | resume機能デプロイ | 8月中旬 | 一時的なスクリプト | ⏳ 未削除 |
| 14 | `deploy_with_env.sh` | 環境変数付きデプロイ | 8/14 | 本日作成、一時的 | ⏳ 未削除 |
| 15 | `manual_deploy.sh` | 手動デプロイ | 8月中旬 | 一時的なスクリプト | ⏳ 未削除 |

### その他ファイル（4ファイル）

| No | ファイル名 | 用途 | 作成時期 | 削除理由 | ステータス |
|----|-----------|------|----------|----------|-----------|
| 16 | `deploy_commands.txt` | デプロイコマンドメモ | 8月中旬 | メモ、不要 | ⏳ 未削除 |
| 17 | `test_scenarios_20250810.md` | テストシナリオ | 8/10 | 古いテスト資料 | ⏳ 未削除 |
| 18 | `urgent_fix_multiple_subscriptions.md` | 緊急修正メモ | 8月中旬 | 修正完了、不要 | ⏳ 未削除 |
| 19 | `cleanup_analysis.md` | 本日の分析資料 | 8/14 | 本作業完了後削除 | ⏳ 未削除 |

## 🔧 削除コマンド

### 一括削除コマンド

```bash
# プロジェクトルートで実行
cd /workspaces/real-estate-app

# SQLファイルの削除
rm -f check_subscription_data.sql \
      check_table_structure.sql \
      debug_subscription.sql \
      fix_subscription_id.sql \
      insert_subscription.sql \
      reset_premium_correct.sql \
      reset_premium_for_user.sql \
      update_subscription_with_real_id.sql

# TypeScript/JavaScriptファイルの削除
rm -f edge_function_debug.ts \
      final_edge_function.ts

# シェルスクリプトの削除
rm -f deploy_create_checkout_session.sh \
      deploy_edge_functions.sh \
      deploy_resume.sh \
      deploy_with_env.sh \
      manual_deploy.sh

# その他ファイルの削除
rm -f deploy_commands.txt \
      test_scenarios_20250810.md \
      urgent_fix_multiple_subscriptions.md \
      cleanup_analysis.md
```

## 📈 効果測定

### 削除前
- プロジェクトルート直下のファイル数: 約30ファイル
- 一時ファイル数: 19ファイル
- 混在率: 63%

### 削除後（予定）
- プロジェクトルート直下のファイル数: 約11ファイル
- 一時ファイル数: 0ファイル
- 整理率: 100%

## ⚠️ 注意事項

1. **Gitでの確認**
   - すべてのファイルがGitにコミット済みであることを確認
   - 必要に応じて`git stash`で一時保存

2. **バックアップ**
   - 削除前に`git status`で変更を確認
   - 削除後も`git`履歴から復元可能

3. **影響範囲**
   - これらのファイルは本番環境では使用されていない
   - 開発・テスト用の一時ファイルのみ

## 🚀 実行手順

1. **事前確認**
   ```bash
   git status  # 未コミットの変更がないか確認
   ```

2. **削除実行**
   ```bash
   # 上記の削除コマンドを実行
   ```

3. **結果確認**
   ```bash
   ls -la  # ルートディレクトリの確認
   git status  # 削除されたファイルの確認
   ```

4. **コミット**
   ```bash
   git add -A
   git commit -m "refactor: プロジェクトルート直下の不要ファイルを削除"
   ```

## 📝 備考

- 削除したファイルはGitの履歴に残るため、必要に応じて復元可能
- 今後は適切なディレクトリ（`scripts/`、`docs_md/`など）にファイルを配置する
- 一時的なテストファイルは`.gitignore`に追加を検討

## ✅ チェックリスト

- [ ] Gitでの変更確認
- [ ] 削除対象ファイルの最終確認
- [ ] 削除コマンドの実行
- [ ] 削除後の動作確認
- [ ] Gitへのコミット
- [ ] チームへの共有

---

**次回のアクション**: 
- サブディレクトリ内の不要ファイルも同様に整理を検討
- `.gitignore`の更新を検討
- CI/CDパイプラインでの自動クリーンアップの検討