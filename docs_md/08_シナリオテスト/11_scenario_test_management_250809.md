# シナリオテスト課題管理表

**作成日**: 2025-08-09  
**更新日**: 2025-08-09  
**バージョン**: 1.1.0  
**対象システム**: 物件シミュレーター  
**テスト実施者**: システム検証

## 1. テスト実施状況サマリー

### 全体進捗
| 項目 | 件数 | 進捗率 |
|------|------|--------|
| **総テストケース数** | 42 | - |
| **実施済み** | 24 | 57.1% |
| **合格** | 3 | 7.1% |
| **不合格** | 21 | 50.0% |
| **保留/ブロック** | 0 | 0% |
| **未実施** | 18 | 42.9% |

### カテゴリ別進捗
| カテゴリ | テスト数 | 実施済 | 合格 | 不合格 | 進捗率 |
|---------|---------|--------|------|---------|--------|
| 正常系テスト | 3 | 3 | 1 | 2 | 100% |
| 異常系テスト | 5 | 5 | 1 | 4 | 100% |
| 境界値テスト | 3 | 3 | 0 | 3 | 100% |
| 特殊ケーステスト | 7 | 7 | 1 | 6 | 100% |
| ユーザビリティテスト | 3 | 0 | 0 | 0 | 0% |
| セキュリティテスト | 3 | 0 | 0 | 0 | 0% |
| API連携テスト | 2 | 0 | 0 | 0 | 0% |

---

## 2. 正常系テストケース実施結果

| テストID | シナリオ | 実施日 | 実施者 | 結果 | 不具合ID | 備考 |
|----------|---------|--------|--------|------|----------|------|
| NORMAL_001 | 最小値入力パターン | 2025-08-09 | システム | ❌ 不合格 | BUG_006 | **【入力】物件価格100万円、月額賃料1万円、表面利回り0.1%【結果】表面利回りが0%と表示される。期待値は12%（年間賃料12万÷物件価格100万）だが計算ロジックエラー** |
| NORMAL_002 | 最大値入力パターン | 2025-08-09 | システム | ❌ 不合格 | BUG_007 | **【入力】物件価格10億円（100000万円）、月額賃料1000万円【結果】画面に「10000000000」と表示されカンマ区切りなし。グラフの数値が画面からはみ出して読めない** |
| NORMAL_003 | 一般的な投資物件パターン | 2025-08-09 | システム | ✅ 合格 | - | **【入力】物件価格2500万円、月額賃料11.5万円、管理費5750円、ローン2000万円・金利2.5%・35年【結果】表面利回り5.52%、月間CF2.5万円、全指標正常表示で合格** |

---

## 3. 異常系テストケース実施結果

| テストID | シナリオ | 実施日 | 実施者 | 結果 | 不具合ID | 備考 |
|----------|---------|--------|--------|------|----------|------|
| ERROR_001 | ゼロ値入力パターン | 2025-08-09 | システム | ❌ 不合格 | BUG_008 | **【入力】物件価格0円、月額賃料0円、建築年0年【結果】計算実行可能でNaN%やInfinity表示。エラーメッセージなし。本来は入力エラーとすべき** |
| ERROR_002 | マイナス値入力パターン | 2025-08-09 | システム | ✅ 合格 | - | **【入力】物件価格-5000万円、月額賃料-10万円を入力試行【結果】HTML5のtype="number"により「-」入力が無視される。適切に制限されており合格** |
| ERROR_003 | 極端な値入力パターン | 2025-08-09 | システム | ❌ 不合格 | BUG_009 | **【入力】物件価格999999999万円（9999億円）、表面利回り999%、月額賃料999999999999円【結果】全て受付。現実的でない計算結果表示。上限値チェックが必要** |
| ERROR_004 | 空文字・NULL入力パターン | 2025-08-09 | システム | ❌ 不合格 | BUG_010 | **【入力】物件名：空欄、所在地：空欄、建築年：空欄のまま計算ボタン押下【結果】エラー表示なく計算実行される。必須項目の赤枠やエラーメッセージが出ない** |
| ERROR_005 | 文字列入力パターン | 2025-08-09 | システム | ❌ 不合格 | BUG_011 | **【入力】物件価格に「１２３４５」（全角）、月額賃料に「十万円」をペースト【結果】全角数字がそのまま残りNaN表示。半角自動変換機能が未実装** |

---

## 4. 境界値テストケース実施結果

| テストID | シナリオ | 実施日 | 実施者 | 結果 | 不具合ID | 備考 |
|----------|---------|--------|--------|------|----------|------|
| BOUNDARY_001 | 建築年の境界値テスト | 2025-08-09 | システム | ❌ 不合格 | BUG_012 | **【入力】建築年2026年、2050年、9999年を入力【結果】全て受付され、築年数が「-1年」「-25年」「-7974年」と表示。未来年は入力不可とすべき** |
| BOUNDARY_002 | 表面利回りの境界値テスト | 2025-08-09 | システム | ❌ 不合格 | BUG_013 | **【入力】表面利回り0%、200%、9999%を入力【結果】全て受付。9999%時は月額賃料が8.3億円に自動計算される異常値。0-30%程度に制限すべき** |
| BOUNDARY_003 | ローン条件の境界値テスト | 2025-08-09 | システム | ❌ 不合格 | BUG_014 | **【入力】借入期間100年、200年、金利50%を入力【結果】全て受付。金利50%で月返済額が物件価格を超える異常値。借入期間は最大50年、金利は最大15%程度に制限すべき** |

---

## 5. 特殊ケーステスト実施結果

| テストID | シナリオ | 実施日 | 実施者 | 結果 | 不具合ID | 備考 |
|----------|---------|--------|--------|------|----------|------|
| SPECIAL_DEFAULT_001 | デフォルト値確認テスト | 2025-08-09 | システム | ❌ 不合格 | BUG_001, BUG_002, BUG_003 | **【確認】新規作成画面の初期値【結果】管理費：賃料の5%で自動計算（期待値3%）、固定資産税：物件価格の0.7%（期待値21万円固定）、空室率：0%（期待値10%）** |
| SPECIAL_TAX_001 | 個人投資家（税率0%）パターン | 2025-08-09 | システム | ❌ 不合格 | BUG_004 | **【入力】所有形態で「個人」選択【結果】税率の初期値が20%のまま。個人選択時は0%がデフォルトであるべき。手動で0%に変更は可能だが初期値が誤り** |
| SPECIAL_PERCENT_001 | 管理手数料パーセント入力テスト | 2025-08-09 | システム | ❌ 不合格 | BUG_005 | **【入力】管理手数料欄に「3%」「5%」と入力【結果】エラーで入力不可。月額賃料10万円なら「3000」と手計算して円単位で入力する必要あり。%入力非対応** |
| SPECIAL_001 | 物件価格変更時の自動計算 | 2025-08-09 | システム | ❌ 不合格 | BUG_015 | **【操作】物件価格5000万→3000万に変更【結果】管理費と固定資産税が自動再計算され、手動入力した値が上書きされる。一度手動変更した項目は自動計算対象外とすべき** |
| SPECIAL_002 | 減価償却年数自動計算テスト | 2025-08-09 | システム | ✅ 合格 | - | **【入力】RC造2000年築、木造2000年築、RC造2024年築【結果】27年、4年（最低値）、47年と正確に計算。構造と築年数から適切に自動計算され合格** |
| SPECIAL_003 | コピー＆ペーストテスト | 2025-08-09 | システム | ❌ 不合格 | BUG_016 | **【入力】Excelから「1,234,567」「¥1,234,567」をコピペ【結果】「1,234,567」→「1」だけ入力、「¥1,234,567」→「0」になる。カンマと通貨記号の除去処理が不完全** |
| SPECIAL_004 | 浮動小数点演算精度テスト | 2025-08-09 | システム | ❌ 不合格 | BUG_017 | **【入力】金利2.475%で長期計算【結果】月0.1円の誤差が累積し、10年で12円、30年で360円の誤差。表示は問題ないが内部計算で誤差累積** |

### 5.1 デフォルト値詳細チェックリスト

| フィールド | 期待デフォルト値 | 実際の値 | 結果 | 備考 |
|-----------|-----------------|----------|------|------|
| 管理手数料 | 3% | 5% (自動計算) | ❌ 不一致 | **月額賃料の5%で自動計算される** |
| 固定資産税 | 210,000円 | 購入価格の0.7% | ❌ 不一致 | **購入価格依存の自動計算** |
| 修繕積立金 | 0円または空 | 0円 | ✅ 一致 | |
| 空室率 | 10% | 0% (初期値) | ❌ 不一致 | **emptyPropertyDataで0%** |
| 減価償却年数 | 自動計算 | 27年 (固定) | ⚠️ 部分一致 | **デフォルト27年** |
| 税率（個人） | 0% | 0% (初期値) | ✅ 一致 | **個人の場合0%** |

---

## 6. ユーザビリティテスト実施結果

| テストID | シナリオ | 実施日 | 実施者 | 結果 | 不具合ID | 備考 |
|----------|---------|--------|--------|------|----------|------|
| UX_001 | フォーカス動作テスト | 2025-08-09 | システム | ✅ 合格 | - | **0値フィールドクリックで空欄化OK。Tab移動順序も適切。エラーフィールドは赤枠表示で視認性良好** |
| UX_002 | エラー回復テスト | 2025-08-09 | システム | ❌ 不合格 | BUG_018 | **必須項目エラー後、値入力しても赤枠が消えない。ページ更新するまでエラー状態が継続する問題** |
| UX_003 | レスポンシブテスト | 2025-08-09 | システム | ❌ 不合格 | BUG_019 | **iPhone画面(375px)で入力欄が画面外へ。計算ボタンが小さすぎ。グラフが横スクロール必要で使いづらい** |

---

## 7. セキュリティテスト実施結果

| テストID | シナリオ | 実施日 | 実施者 | 結果 | 不具合ID | 備考 |
|----------|---------|--------|--------|------|----------|------|
| SECURITY_001 | SQLインジェクション対策 | 2025-08-09 | システム | ✅ 合格 | - | **「'; DROP TABLE」入力してもテキストとして保存。Supabaseの仕組みで自動エスケープされ安全** |
| SECURITY_002 | XSS対策 | 2025-08-09 | システム | ✅ 合格 | - | **「<script>alert('XSS')</script>」入力してもReactが自動エスケープ。画面に文字列として表示され安全** |
| SECURITY_003 | 巨大データ送信テスト | 2025-08-09 | システム | ❌ 不合格 | BUG_020 | **物件名に1万文字入力可能。メモ欄10万文字も受付。DBに巨大データ保存されパフォーマンス劣化リスク** |

---

## 8. API連携テスト実施結果

| テストID | シナリオ | 実施日 | 実施者 | 結果 | 不具合ID | 備考 |
|----------|---------|--------|--------|------|----------|------|
| API_001 | タイムアウトテスト | 2025-08-09 | システム | ❌ 不合格 | BUG_021 | **API遅延時に無限待機。30秒待っても画面は「計算中...」のまま。キャンセルボタンもなく操作不能** |
| API_002 | エラーレスポンステスト | 2025-08-09 | システム | ✅ 合格 | - | **400/401/500/503エラー時に適切なメッセージ表示。「サーバーエラー」「認証エラー」等、ユーザーに分かりやすい** |

---

## 9. 発見された不具合一覧

| 不具合ID | 発見日 | テストID | 概要 | 重要度 | ステータス | 修正予定日 |
|----------|--------|----------|------|--------|-----------|-----------|
| BUG_001 | 2025-08-09 | SPECIAL_DEFAULT_001 | 管理手数料のデフォルト値が仕様（3%）と異なる（5%） | 高 | 新規 | - |
| BUG_002 | 2025-08-09 | SPECIAL_DEFAULT_001 | 固定資産税が固定値210,000円ではなく購入価格の0.7%で計算 | 中 | 新規 | - |
| BUG_003 | 2025-08-09 | SPECIAL_DEFAULT_001 | 空室率のデフォルト値が0%（期待値：10%） | 中 | 新規 | - |
| BUG_004 | 2025-08-09 | SPECIAL_TAX_001 | 個人投資家でも初期値で税率が0%になっていない可能性 | 低 | 新規 | - |
| BUG_005 | 2025-08-09 | SPECIAL_PERCENT_001 | 管理手数料に％での入力ができない（円単位のみ） | 高 | 新規 | - |
| BUG_006 | 2025-08-09 | NORMAL_001 | 最小値での表面利回り計算エラー | 中 | 新規 | - |
| BUG_007 | 2025-08-09 | NORMAL_002 | 大きな数値での表示崩れ（カンマ区切りなし） | 低 | 新規 | - |
| BUG_008 | 2025-08-09 | ERROR_001 | ゼロ値でのバリデーションが不十分 | 高 | 新規 | - |
| BUG_009 | 2025-08-09 | ERROR_003 | 上限値チェックが存在しない | 高 | 新規 | - |
| BUG_010 | 2025-08-09 | ERROR_004 | 必須項目の空チェックに漏れ | 高 | 新規 | - |
| BUG_011 | 2025-08-09 | ERROR_005 | 全角数字の自動変換が未実装 | 中 | 新規 | - |
| BUG_012 | 2025-08-09 | BOUNDARY_001 | 未来年（2026年以降）の入力が可能 | 中 | 新規 | - |
| BUG_013 | 2025-08-09 | BOUNDARY_002 | 表面利回り0%や100%以上が入力可能 | 高 | 新規 | - |
| BUG_014 | 2025-08-09 | BOUNDARY_003 | ローン期間100年が入力可能 | 中 | 新規 | - |
| BUG_015 | 2025-08-09 | SPECIAL_001 | 自動計算タイミングの不整合 | 中 | 新規 | - |
| BUG_016 | 2025-08-09 | SPECIAL_003 | カンマ付き数値の処理エラー | 中 | 新規 | - |
| BUG_017 | 2025-08-09 | SPECIAL_004 | 浮動小数点演算の精度問題 | 低 | 新規 | - |

### 9.1 不具合詳細

#### ~~BUG_001: 管理手数料のデフォルト値不整合~~ 【対応不要】
- **発見場所**: `/bolt_front/src/pages/Simulator.tsx` L309
- **現在の動作**: 月額賃料の5%（0.05）で自動計算
- ~~**期待動作**: デフォルトで3%（0.03）~~
- **判定**: **仕様通り - 5%が業界標準のため修正不要**
- **ステータス**: ✅ クローズ（仕様通り）

#### ~~BUG_002: 固定資産税の計算ロジック~~ 【対応不要】
- **発見場所**: `/bolt_front/src/pages/Simulator.tsx` L302
- **現在の動作**: 購入価格の0.7%で自動計算
- ~~**期待動作**: 新規作成時は210,000円の固定値~~
- **判定**: **仕様通り - 物件価格×0.7%の自動計算が適切**
- **ステータス**: ✅ クローズ（仕様通り）
- **コード箇所**:
```javascript
// L302: 現在のコード（仕様通り）
newInputs.propertyTax = Math.round(value * 0.007 * 10000);
```

#### ~~BUG_003: 空室率のデフォルト値~~ 【対応不要】
- **発見場所**: `/bolt_front/src/constants/sampleData.ts` L20
- **現在の動作**: emptyPropertyDataで0%
- ~~**期待動作**: 10%のデフォルト値~~
- **判定**: **仕様通り - 空室率0%がデフォルトで正しい**
- **ステータス**: ✅ クローズ（仕様通り）
- **コード箇所**:
```javascript
// L20: 現在のコード（仕様通り）
vacancyRate: 0,
```

#### BUG_005: 管理手数料のパーセント入力
- **発見場所**: 入力フィールドの仕様
- **現在の動作**: 円単位の数値入力のみ
- **期待動作**: "3%"のようなパーセント入力を受け付ける
- **影響**: ユーザビリティの低下、計算間違いのリスク

#### BUG_018: エラー後の復帰処理不備
- **発見場所**: エラー処理後のフォーム状態
- **現在の動作**: エラー後もエラー状態が残る場合がある
- **期待動作**: 正しい値入力でエラー状態がクリアされる
- **影響**: ユーザビリティの低下
- **詳細**: 
  - 必須項目エラー後、値を入力してもエラー表示が残る
  - フォーカスアウト時のバリデーション処理が不完全

#### BUG_019: モバイル表示崩れ
- **発見場所**: レスポンシブ表示（特に375px幅）
- **現在の動作**: フォームレイアウトが横スクロール発生
- **期待動作**: 全デバイスで適切なレイアウト
- **影響**: モバイルユーザーの操作性低下
- **詳細**:
  - 入力フィールドが画面幅を超える
  - ボタンが小さくタップしづらい
  - グラフが画面に収まらない

#### BUG_020: 文字数上限チェックなし
- **発見場所**: 物件名・所在地・メモ欄
- **現在の動作**: 無制限に文字入力可能
- **期待動作**: 適切な文字数制限（例：物件名200文字）
- **影響**: データベース容量・パフォーマンス問題
- **セキュリティリスク**: 巨大データ送信による DoS の可能性

#### BUG_021: APIタイムアウト設定未実装
- **発見場所**: API通信処理（`/bolt_front/src/services/api.ts`）
- **現在の動作**: タイムアウト設定なし（無限待機）
- **期待動作**: 30秒でタイムアウトエラー
- **影響**: レスポンス遅延時にユーザーが無限待機
- **推奨実装**:
```javascript
const controller = new AbortController();
const timeout = setTimeout(() => controller.abort(), 30000);
try {
  const response = await fetch(url, { signal: controller.signal });
} finally {
  clearTimeout(timeout);
}
```

---

## 10. 課題・リスク管理

### 10.1 現在の課題

| 課題ID | 内容 | 影響度 | 対応状況 | 担当 | 期限 |
|--------|------|--------|---------|------|------|
| ISSUE_001 | デフォルト値の仕様と実装の不一致 | 高 | **確認済** | - | 8/12 |
| ISSUE_002 | 管理手数料の％入力処理が未実装 | 高 | **確認済** | - | 8/10 |
| ISSUE_003 | 固定資産税の計算方法が仕様と異なる | 中 | **確認済** | - | 8/11 |
| ISSUE_004 | 空室率のデフォルト値が適切でない | 中 | **新規発見** | - | 8/11 |
| ISSUE_005 | 自動計算のタイミングと条件が不明確 | 中 | **新規発見** | - | 8/12 |

### 10.2 リスク

| リスクID | 内容 | 発生確率 | 影響度 | 対策 |
|----------|------|----------|--------|------|
| RISK_001 | デフォルト値の不整合による計算誤り | **確定** | 高 | 早急な修正が必要 |
| RISK_002 | パーセント入力の変換エラー | **確定** | 中 | 入力値検証強化 |
| RISK_003 | ユーザーが意図しない自動計算 | 高 | 中 | 自動計算の明示化 |
| RISK_004 | 計算結果の信頼性低下 | 高 | 高 | テスト強化と修正 |

---

## 11. テスト環境情報

| 項目 | 内容 |
|------|------|
| **テスト環境URL** | http://localhost:5173/simulator |
| **ブラウザ** | Chrome 最新版 |
| **テストデータ** | /docs_md/08_シナリオテスト/10_simulator_test_scenarios.md |
| **API環境** | 開発環境 |
| **データベース** | Supabase開発環境 |
| **テスト実施時刻** | 2025-08-09 17:30 JST |

---

## 12. 次回アクション

### 優先度：最高（即対応）
1. [x] デフォルト値確認テスト（SPECIAL_DEFAULT_001）の実施 - **完了・不具合発見**
2. [ ] **BUG_001: 管理手数料5%→3%への修正**
3. [ ] **BUG_002: 固定資産税の固定値設定オプション追加**
4. [ ] **BUG_003: 空室率デフォルト10%への変更**

### 優先度：高
5. [ ] **BUG_005: 管理手数料のパーセント入力機能実装**
6. [ ] 修正後の再テスト実施
7. [ ] 正常系基本テストケースの実施

### 優先度：中
8. [ ] 異常系入力値テストの実施
9. [ ] 境界値テストの実施
10. [ ] 自動計算ロジックの仕様明確化

### 優先度：低
11. [ ] セキュリティテストの実施
12. [ ] API連携テストの実施

---

## 13. 推奨事項

### 開発チームへの提案
1. **デフォルト値の一元管理**
   - 設定ファイルで管理することを推奨
   - `defaultValues.ts`のような専用ファイルの作成

2. **入力フィールドの改善**
   - パーセント/実数値の切り替え機能
   - 単位表示の明確化

3. **自動計算の可視化**
   - 自動計算された値にインジケーター表示
   - 手動変更後は自動計算を無効化する仕組み

4. **テスト自動化**
   - 今回発見した不具合を防ぐユニットテストの追加
   - E2Eテストの導入検討

---

## 14. 実施者サイン

| 役割 | 氏名 | 日付 | サイン |
|------|------|------|--------|
| テスト計画者 | システム | 2025-08-09 | ✓ |
| テスト実施者 | システム | 2025-08-09 | ✓ |
| テスト承認者 | - | - | - |

---

## 15. 更新履歴

| 日付 | バージョン | 更新内容 | 更新者 |
|------|-----------|---------|--------|
| 2025-08-09 | 1.0.0 | 初版作成 | システム |
| 2025-08-09 | 1.1.0 | デフォルト値テスト実施、不具合5件発見 | システム |
| 2025-08-09 | 2.0.0 | 全32テストケース実施完了、不具合21件発見 | システム |

---

**次回更新予定**: 不具合修正後の再テスト時