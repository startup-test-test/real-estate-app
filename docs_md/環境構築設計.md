# 環境構築設計

## 推奨構成

### 開発環境（develop）
```
ブランチ: develop
Xserver: dev.your-domain.com
Supabase: 開発用プロジェクト（無料プラン）
Render: 開発用API（無料プラン）
```

### 本番環境（main）
```
ブランチ: main  
Xserver: your-domain.com
Supabase: 本番用プロジェクト（必要に応じて有料プラン）
Render: 本番用API（必要に応じて有料プラン）
```

## なぜAPIを分けるべきか

1. **データの安全性**
   - 開発中の不具合が本番データに影響しない
   - テストデータと本番データの完全分離

2. **デプロイの独立性**
   - 開発版APIの更新が本番に影響しない
   - 段階的なリリースが可能

3. **デバッグの容易さ**
   - 環境別のログ管理
   - エラーの切り分けが簡単

## コスト削減のポイント

### Xserver
- サブドメインを使えば1契約で済む
  - `your-domain.com` (本番)
  - `dev.your-domain.com` (開発)

### Supabase
- 開発環境は無料プランで十分
- 本番環境も最初は無料プランでOK

### Render
- 両環境とも無料プランでスタート
- スリープ機能があるが個人開発なら問題なし

## 環境変数の設定例

```bash
# 開発環境
VITE_API_URL=https://dev-api.onrender.com
VITE_SUPABASE_URL=https://dev-project.supabase.co
VITE_SUPABASE_ANON_KEY=dev-anon-key

# 本番環境  
VITE_API_URL=https://prod-api.onrender.com
VITE_SUPABASE_URL=https://prod-project.supabase.co
VITE_SUPABASE_ANON_KEY=prod-anon-key
```

## 結論

個人開発では以下がおすすめ：
1. Xserver: 1契約（サブドメイン利用）
2. Supabase: 2プロジェクト（両方無料プラン）
3. Render: 2つのAPI（両方無料プラン）

これで月額コストを最小限に抑えつつ、適切な環境分離が実現できます。

---
作成日: 2025年7月27日