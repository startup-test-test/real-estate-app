# メール認証エラー解決方法

## 問題
メール確認リンクをクリックすると、`/auth/callback`ページが真っ白になる

## 原因
1. ポート番号の不一致（5173 vs 5174）
2. GitHub CodespacesのURL変更
3. トークン検証の処理エラー

## 解決方法

### 1. Supabaseダッシュボードで確認
1. **Authentication** → **URL Configuration**
2. **Redirect URLs**に以下を追加：
   ```
   http://localhost:5173/auth/callback
   http://localhost:5174/auth/callback
   https://*.app.github.dev/auth/callback
   ```

### 2. メールテンプレートの確認
1. **Authentication** → **Email Templates**
2. **Confirm signup**テンプレートで、リダイレクトURLが正しく設定されているか確認

### 3. 開発環境での対処法

#### 方法A: 固定ポートを使用
```bash
# package.jsonを編集
"scripts": {
  "dev": "vite --port 5173"
}
```

#### 方法B: 環境変数でリダイレクトURLを設定
```env
VITE_REDIRECT_URL=https://your-codespace-url.app.github.dev
```

### 4. デバッグ手順
1. ブラウザの開発者ツールを開く
2. Consoleタブでエラーを確認
3. Networkタブでリクエストの詳細を確認

### 5. 一時的な回避策
メール確認リンクのURLを手動で修正：
1. メールのリンクをコピー
2. URLの`redirect_to`パラメータを現在のCodespaceのURLに変更
3. 修正したURLをブラウザに貼り付け

## テスト確認項目
- [ ] ポート番号が一致しているか
- [ ] SupabaseのRedirect URLsに現在のURLが登録されているか
- [ ] AuthCallbackコンポーネントが正しく動作しているか
- [ ] トークン検証が成功しているか